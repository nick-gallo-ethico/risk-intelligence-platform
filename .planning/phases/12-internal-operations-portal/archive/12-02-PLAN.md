---
phase: 12-internal-operations-portal
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/backend/prisma/schema.prisma
  - apps/backend/src/modules/operations/implementation/entities/implementation.entity.ts
  - apps/backend/src/modules/operations/implementation/dto/implementation.dto.ts
  - apps/backend/src/modules/operations/implementation/types/implementation.types.ts
  - apps/backend/src/modules/operations/implementation/implementation.module.ts
  - apps/backend/src/modules/operations/implementation/index.ts
autonomous: true

must_haves:
  truths:
    - "Implementation projects track client onboarding with type-based timelines"
    - "Tasks belong to phases with required/optional designation"
    - "Blockers can be created and linked to tasks with resolution tracking"
    - "Project status is derived from task completion and blocker state"
  artifacts:
    - path: "apps/backend/prisma/schema.prisma"
      provides: "ImplementationProject, ImplementationTask, ImplementationBlocker models"
      contains: "model ImplementationProject"
    - path: "apps/backend/src/modules/operations/implementation/entities/implementation.entity.ts"
      provides: "TypeScript entities for implementation models"
      exports: ["ImplementationProject", "ImplementationTask", "ImplementationBlocker"]
    - path: "apps/backend/src/modules/operations/implementation/types/implementation.types.ts"
      provides: "Enums and interfaces for implementation"
      exports: ["ImplementationType", "ImplementationStatus", "ImplementationPhase", "TaskStatus"]
  key_links:
    - from: "ImplementationProject"
      to: "Organization"
      via: "organizationId FK"
      pattern: "organizationId.*Organization"
    - from: "ImplementationTask"
      to: "ImplementationProject"
      via: "projectId FK"
      pattern: "projectId.*ImplementationProject"
---

<objective>
Create the database models for implementation project tracking - projects, tasks, and blockers that enable Implementation Specialists to manage client onboarding systematically.

Purpose: Implementation team currently uses spreadsheets for project tracking. This infrastructure enables standardized checklist-based implementation with visibility into blockers, progress, and go-live readiness.

Output: Prisma models for ImplementationProject, ImplementationTask, ImplementationBlocker with proper relations; TypeScript entities and DTOs.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-internal-operations-portal/CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Implementation Prisma models to schema</name>
  <files>apps/backend/prisma/schema.prisma</files>
  <action>
Add the following models to schema.prisma:

1. **ImplementationType enum**:
   - QUICK_START (2-4 weeks)
   - STANDARD (4-8 weeks)
   - COMPLEX (8-16 weeks)
   - ENTERPRISE (3-6 months)

2. **ImplementationStatus enum**:
   - NOT_STARTED, DISCOVERY, CONFIGURATION, MIGRATION
   - TRAINING, UAT, GO_LIVE_PREP, COMPLETED, ON_HOLD

3. **ImplementationPhase enum** (matches CONTEXT.md checklist phases):
   - FOUNDATION, USERS_ACCESS, CASE_MANAGEMENT
   - INTEGRATIONS, DATA_MIGRATION, TRAINING
   - GO_LIVE_READINESS, HANDOFF

4. **TaskStatus enum**:
   - PENDING, IN_PROGRESS, COMPLETED, BLOCKED, SKIPPED

5. **ImplementationProject model**:
   - id (String @id @default(uuid()))
   - organizationId (String) - FK to Organization (the client tenant)
   - type (ImplementationType)
   - status (ImplementationStatus @default(NOT_STARTED))
   - name (String) - Project name (usually org name + "Implementation")
   - specialistId (String) - FK to InternalUser (primary owner)
   - managerId (String?) - FK to InternalUser (for complex/enterprise)
   - goLiveDate (DateTime?) - Target go-live
   - actualGoLiveDate (DateTime?) - Actual completion
   - healthScore (Int @default(0)) - 0-100 calculated
   - totalTasks (Int @default(0)) - Denormalized
   - completedTasks (Int @default(0)) - Denormalized
   - blockedTasks (Int @default(0)) - Denormalized
   - notes (String?) - General project notes
   - createdAt, updatedAt
   - Relations: organization Organization, specialist InternalUser, manager InternalUser?, tasks ImplementationTask[], blockers ImplementationBlocker[]
   - Indexes: organizationId, specialistId, (status, goLiveDate)

6. **ImplementationTask model**:
   - id (String @id @default(uuid()))
   - projectId (String) - FK to ImplementationProject
   - phase (ImplementationPhase)
   - name (String)
   - description (String?)
   - status (TaskStatus @default(PENDING))
   - isRequired (Boolean @default(true))
   - sortOrder (Int) - Order within phase
   - dueDate (DateTime?)
   - completedAt (DateTime?)
   - completedById (String?) - FK to InternalUser who completed
   - notes (String?)
   - createdAt, updatedAt
   - Relations: project ImplementationProject, completedBy InternalUser?, blockers ImplementationBlocker[]
   - Indexes: projectId, (projectId, phase), (projectId, status)

7. **BlockerSeverity enum**:
   - LOW, MEDIUM, HIGH, CRITICAL

8. **ImplementationBlocker model**:
   - id (String @id @default(uuid()))
   - projectId (String) - FK to ImplementationProject
   - taskId (String?) - FK to ImplementationTask (optional - can be project-level)
   - title (String)
   - description (String)
   - severity (BlockerSeverity @default(MEDIUM))
   - isResolved (Boolean @default(false))
   - resolvedAt (DateTime?)
   - resolvedById (String?) - FK to InternalUser
   - resolution (String?) - How it was resolved
   - createdById (String) - FK to InternalUser
   - createdAt, updatedAt
   - Relations: project ImplementationProject, task ImplementationTask?, resolvedBy InternalUser?, createdBy InternalUser
   - Indexes: projectId, taskId, (projectId, isResolved)

Run `npx prisma generate` after adding models.
  </action>
  <verify>npx prisma validate passes without errors</verify>
  <done>ImplementationProject, ImplementationTask, ImplementationBlocker models exist with proper enums, relations, and indexes</done>
</task>

<task type="auto">
  <name>Task 2: Create TypeScript entities, types, and DTOs</name>
  <files>
    apps/backend/src/modules/operations/implementation/entities/implementation.entity.ts
    apps/backend/src/modules/operations/implementation/types/implementation.types.ts
    apps/backend/src/modules/operations/implementation/dto/implementation.dto.ts
    apps/backend/src/modules/operations/implementation/implementation.module.ts
    apps/backend/src/modules/operations/implementation/index.ts
  </files>
  <action>
Create the directory structure and files:

**types/implementation.types.ts:**
```typescript
// Re-export enums from Prisma for convenience
export {
  ImplementationType,
  ImplementationStatus,
  ImplementationPhase,
  TaskStatus,
  BlockerSeverity,
} from '@prisma/client';

// Checklist template structure
export interface ChecklistTemplateTask {
  name: string;
  description?: string;
  isRequired: boolean;
  estimatedHours?: number;
}

export interface ChecklistTemplatePhase {
  phase: ImplementationPhase;
  name: string;
  tasks: ChecklistTemplateTask[];
}

export interface ChecklistTemplate {
  type: ImplementationType;
  phases: ChecklistTemplatePhase[];
}

// Project with calculated fields
export interface ProjectWithStats {
  id: string;
  name: string;
  type: ImplementationType;
  status: ImplementationStatus;
  healthScore: number;
  totalTasks: number;
  completedTasks: number;
  blockedTasks: number;
  progressPercent: number;
  daysToGoLive?: number;
  isAtRisk: boolean;
}
```

**entities/implementation.entity.ts:**
- Define TypeScript classes/interfaces matching Prisma models
- Include relations as optional types
- Export ImplementationProjectEntity, ImplementationTaskEntity, ImplementationBlockerEntity

**dto/implementation.dto.ts:**
- CreateProjectDto: organizationId, type, name, specialistId, managerId?, goLiveDate?, notes?
- UpdateProjectDto: Partial of CreateProjectDto plus status
- CreateTaskDto: projectId, phase, name, description?, isRequired, sortOrder, dueDate?
- UpdateTaskDto: status, completedAt?, completedById?, notes?, dueDate?
- CreateBlockerDto: projectId, taskId?, title, description, severity
- ResolveBlockerDto: resolution (string)
- ProjectQueryDto: status?, specialistId?, type?, page?, limit?

**implementation.module.ts:**
```typescript
import { Module } from '@nestjs/common';

@Module({
  imports: [],
  providers: [],
  exports: [],
})
export class ImplementationModule {}
```

**index.ts:**
- Export all types, entities, DTOs
  </action>
  <verify>npx tsc --noEmit compiles without errors</verify>
  <done>TypeScript entities, types, and DTOs are complete and exported</done>
</task>

</tasks>

<verification>
1. Run `npx prisma validate` - schema is valid
2. Run `npx prisma generate` - Prisma client generates
3. Run `npx tsc --noEmit` from apps/backend - TypeScript compiles
4. Verify all enums match between Prisma schema and TypeScript types
5. Verify ImplementationModule is importable
</verification>

<success_criteria>
- ImplementationProject, ImplementationTask, ImplementationBlocker Prisma models exist
- Enums: ImplementationType, ImplementationStatus, ImplementationPhase, TaskStatus, BlockerSeverity
- TypeScript entities match Prisma models
- DTOs for CRUD operations defined
- ChecklistTemplate interface supports template-based task generation
- ProjectWithStats interface includes calculated fields for dashboard display
</success_criteria>

<output>
After completion, create `.planning/phases/12-internal-operations-portal/12-02-SUMMARY.md`
</output>
