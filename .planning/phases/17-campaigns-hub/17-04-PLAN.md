---
phase: 17-campaigns-hub
plan: 04
type: execute
wave: 2
depends_on: ["01", "02", "03"]
files_modified:
  - apps/backend/prisma/seeders/acme-phase-17.ts
  - apps/backend/prisma/seed.ts
autonomous: false

must_haves:
  truths:
    - "Active and completed campaigns visible in hub"
    - "Draft campaign ready for editing demonstration"
    - "Multiple form types available in Forms section"
    - "Campaign dashboard shows completion rates and overdue counts"
    - "Campaign detail page shows assignments with status indicators"
    - "Forms list shows forms grouped by type with draft and published statuses"
  artifacts:
    - path: "apps/backend/prisma/seeders/acme-phase-17.ts"
      provides: "Phase 17 demo data seed script"
      contains: "seedPhase17"
  key_links:
    - from: "apps/backend/prisma/seeders/acme-phase-17.ts"
      to: "apps/backend/prisma/seed.ts"
      via: "import and invocation in main seed"
      pattern: "seedPhase17|acme-phase-17"
---

<objective>
Seed Acme Co. demo tenant with Phase 17 campaign hub data and verify all 8 phase success criteria.

Purpose: The ROADMAP.md demo data strategy requires every phase to include demo data seeding so the platform looks "lived-in" for sales demos. Phase 17 needs campaigns in various lifecycle stages and form definitions across multiple types to demonstrate the campaigns hub and forms section.

Output: acme-phase-17.ts seed script creating realistic campaign and form data, integrated into the main seed orchestrator, plus verification of all Phase 17 success criteria.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-campaigns-hub/17-RESEARCH.md
@.planning/phases/17-campaigns-hub/17-01-SUMMARY.md
@.planning/phases/17-campaigns-hub/17-02-SUMMARY.md
@.planning/phases/17-campaigns-hub/17-03-SUMMARY.md
@apps/backend/prisma/seeders/acme-phase-09.ts
@apps/backend/prisma/seeders/acme-phase-12.ts
@apps/backend/prisma/seed.ts
@apps/backend/prisma/seeders/index.ts
@apps/frontend/src/types/campaign.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Phase 17 demo data seed script</name>
  <files>
apps/backend/prisma/seeders/acme-phase-17.ts
apps/backend/prisma/seed.ts
  </files>
  <action>
Create `apps/backend/prisma/seeders/acme-phase-17.ts` following the same pattern as `acme-phase-09.ts` and `acme-phase-12.ts`.

**Script structure:**

1. Import PrismaClient and faker
2. Look up the Acme Corp organization by slug 'acme-corp'
3. Look up existing users (compliance officer, system admin) for createdById references
4. Look up existing employees for campaign assignment targets

**Seed campaigns (8-10 campaigns across lifecycle stages):**

Create campaigns using `prisma.campaign.upsert` (upsert by a deterministic ID or unique name+org constraint) covering these statuses:

- 2 COMPLETED campaigns (past due dates, 85-95% completion rate):
  - "Q4 2025 Annual COI Disclosure" - type DISCLOSURE, completed 2025-12-15, 92% completion
  - "2025 Code of Conduct Attestation" - type ATTESTATION, completed 2025-11-30, 88% completion

- 2 ACTIVE campaigns (current, partially complete):
  - "Q1 2026 Gift & Entertainment Disclosure" - type DISCLOSURE, launched 2026-01-15, due 2026-02-28, ~45% completion, some overdue assignments
  - "Annual Ethics Training Attestation" - type ATTESTATION, launched 2026-01-20, due 2026-03-15, ~30% completion

- 1 PAUSED campaign:
  - "Employee Satisfaction Survey 2026" - type SURVEY, launched then paused, ~15% completion

- 1 SCHEDULED campaign:
  - "Q2 2026 Outside Employment Review" - type DISCLOSURE, scheduled to launch 2026-03-01

- 2 DRAFT campaigns:
  - "New Hire Onboarding Campaign" - type ATTESTATION, no assignments yet (ready for editing demo)
  - "Whistleblower Policy Acknowledgment" - type ATTESTATION, draft

For each ACTIVE and COMPLETED campaign, create 15-30 CampaignAssignment records with various statuses (COMPLETED, PENDING, IN_PROGRESS, OVERDUE, NOTIFIED). Use existing employee IDs from the Acme org. Include employeeSnapshot JSON with name/email/department for each assignment.

Update denormalized stats on each campaign: totalAssignments, completedAssignments, overdueAssignments.

**Seed form definitions (6-8 forms across types):**

Create FormDefinition records (or the equivalent model) covering multiple form types:

- "Conflict of Interest Disclosure Form" - type DISCLOSURE, status PUBLISHED, version 3
- "Annual Gift & Entertainment Form" - type DISCLOSURE, status PUBLISHED, version 2
- "Code of Conduct Attestation" - type ATTESTATION, status PUBLISHED, version 1
- "Ethics Training Completion" - type ATTESTATION, status PUBLISHED, version 1
- "Employee Satisfaction Survey" - type SURVEY, status DRAFT, version 1
- "New Hire Intake Form" - type INTAKE, status PUBLISHED, version 2
- "Whistleblower Report Form" - type CUSTOM, status DRAFT, version 1
- "Outside Employment Declaration" - type DISCLOSURE, status PUBLISHED, version 1

Each form should have a basic schema JSON (sections with a few fields each) to demonstrate the form builder loads real data.

**Integration with main seed:**

Add import and invocation of `seedPhase17` in `apps/backend/prisma/seed.ts` after the existing phase seeders. Follow the same pattern used for acme-phase-09 and acme-phase-12 (standalone execution via `require.main === module` plus export for orchestrator).

**Important conventions (from existing seeders):**

- Use `crypto.randomUUID()` or `faker.string.uuid()` for IDs
- Use upsert where possible for idempotency
- Log progress with console.log statements
- Export a main `seedPhase17` function that accepts PrismaClient
- Include standalone execution block at bottom (`if (require.main === module)`)
- Reference the Acme Corp org by slug lookup, not hardcoded ID
  </action>
  <verify>
  Run `cd apps/backend && npx tsc --noEmit 2>&1 | head -20` to verify the seed script compiles. Verify the file exists with `ls apps/backend/prisma/seeders/acme-phase-17.ts`.
  </verify>
  <done>Phase 17 seed script creates 8-10 campaigns in various lifecycle stages with assignments, and 6-8 form definitions across multiple types. Script integrated into main seed orchestrator.</done>
  </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Phase 17 Campaigns Hub implementation across 4 plans:
- Plan 01: Backend dashboard endpoints + sidebar navigation + /campaigns/new page
- Plan 02: Campaign detail page with overview, assignments, lifecycle actions
- Plan 03: Forms hub with list, create, and edit pages
- Plan 04: Demo data seeding for campaigns and forms
  </what-built>
  <how-to-verify>

### Demo Data Checkpoint

- [ ] New entity types have Acme Co. data seeded (campaigns in various statuses, form definitions)
- [ ] New entities connected to existing data (campaign assignments reference existing employees)
- [ ] Fresh items in queues (active campaigns with pending/overdue assignments, draft campaigns for editing)
- [ ] Seed script runs without errors: `cd apps/backend && npx ts-node prisma/seeders/acme-phase-17.ts`

### Phase 17 Success Criteria Verification

1. **Centralized /campaigns page**: Navigate to /campaigns. Verify it shows all campaigns across types with filters and status. Seeded campaigns (ACTIVE, COMPLETED, DRAFT, PAUSED, SCHEDULED) should appear.

2. **Create new campaigns**: Click "Create Campaign" from the hub. Verify /campaigns/new renders the CampaignBuilder wizard with type selection.

3. **Campaign detail editing**: Click on a seeded campaign from the list. Verify /campaigns/[id] shows overview with stats, status, type, assignments list, and lifecycle action buttons.

4. **Campaign release/status tracking**: On an ACTIVE campaign detail page, verify Pause/Cancel buttons appear. On a DRAFT campaign, verify Launch button appears. On a PAUSED campaign, verify Resume button appears.

5. **Form builder accessible**: From campaigns hub, click "Manage Forms" or navigate to /forms. Verify the Forms section is accessible.

6. **Dedicated Forms section**: Navigate to /forms via sidebar. Verify it shows all RIU form types (disclosures, attestations, surveys, intake, custom) from seeded data.

7. **Campaign dashboard stats**: Verify the campaigns list page shows summary cards with completion rates and overdue counts populated from seeded data.

8. **Form builder create/edit**: Click "Create Form" on /forms page. Verify FormBuilder loads. Click on an existing form. Verify FormBuilder loads with initial data.

  </how-to-verify>
  <resume-signal>Type "approved" if all 8 success criteria pass, or describe which criteria failed and what you observed.</resume-signal>
</task>

</tasks>

<verification>
- acme-phase-17.ts exists and compiles without TypeScript errors
- Seed script creates campaigns in all required lifecycle stages (ACTIVE, COMPLETED, DRAFT, PAUSED, SCHEDULED)
- Seed script creates form definitions across multiple types (DISCLOSURE, ATTESTATION, SURVEY, INTAKE, CUSTOM)
- Campaign assignments exist with various statuses for active/completed campaigns
- All 8 Phase 17 success criteria verified via human checkpoint
</verification>

<success_criteria>

1. Seed script runs without errors and creates demo data
2. Active and completed campaigns visible in campaigns hub
3. Draft campaign available for editing demonstration
4. Multiple form types visible in Forms section
5. All 8 Phase 17 success criteria pass human verification
   </success_criteria>

<output>
After completion, create `.planning/phases/17-campaigns-hub/17-04-SUMMARY.md`
</output>
