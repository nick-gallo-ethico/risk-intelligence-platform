---
phase: 09-campaigns-disclosures
plan: 17
type: execute
wave: 5
depends_on: ["09-05"]
files_modified:
  - apps/frontend/src/components/conflicts/ConflictAlert.tsx
  - apps/frontend/src/components/conflicts/ConflictQueue.tsx
  - apps/frontend/src/components/conflicts/EntityTimeline.tsx
  - apps/frontend/src/pages/compliance/conflicts.tsx
autonomous: true

must_haves:
  truths:
    - "Conflicts displayed with full context"
    - "Dismissal flow captures category and reason"
    - "Entity timeline shows complete history"
  artifacts:
    - path: "apps/frontend/src/components/conflicts/ConflictAlert.tsx"
      provides: "Contextual conflict display"
      exports: ["ConflictAlert"]
    - path: "apps/frontend/src/components/conflicts/ConflictQueue.tsx"
      provides: "Conflict review queue"
      exports: ["ConflictQueue"]
    - path: "apps/frontend/src/components/conflicts/EntityTimeline.tsx"
      provides: "Entity history timeline"
      exports: ["EntityTimeline"]
  key_links:
    - from: "apps/frontend/src/components/conflicts/ConflictQueue.tsx"
      to: "/api/v1/conflicts"
      via: "API calls"
      pattern: "fetch.*conflicts"
---

<objective>
Create the conflict review UI per RS.42-RS.45, RS.49 - contextual alerts display, dismissal flow with categories, and entity timeline view.

Purpose: Enable compliance reviewers to efficiently review detected conflicts, dismiss false positives with proper categorization, and investigate entity history across all disclosures. This is the 09-D4 work item from the spec.

Output:
- ConflictAlert component showing full context
- ConflictQueue for reviewing pending conflicts
- EntityTimeline for historical view
- Conflicts page
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/09-campaigns-disclosures/09-CONTEXT.md
@.planning/phases/09-campaigns-disclosures/09-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ConflictAlert component</name>
  <files>apps/frontend/src/components/conflicts/ConflictAlert.tsx</files>
  <action>
Create contextual conflict alert per RS.42-RS.43:

Card layout showing:
- Severity badge (color coded: LOW, MEDIUM, HIGH, CRITICAL)
- Conflict type icon
- Summary text
- Confidence percentage

"Your disclosure" section:
- Entity name disclosed
- Relationship type
- Value (if applicable)

"Matched against" section:
- Source name (vendor, employee, disclosure, case)
- Match score percentage
- Relevant context details based on source type

"Why this matters" section:
- Brief explanation of conflict implications
- Link to relevant policy (if configured)

Actions:
- [View Details] - Expand for full context
- [Dismiss] - Opens dismissal flow
- [Escalate] - Creates case (if not already)
- [View Entity] - Opens EntityTimeline

Dismissal flow (in dialog):
- Category selector (radio buttons)
- Reason text area
- "Don't flag this again" checkbox (creates exclusion)
- Confirm button
  </action>
  <verify>cd apps/frontend && npx tsc --noEmit</verify>
  <done>ConflictAlert compiles with contextual display and dismissal flow.</done>
</task>

<task type="auto">
  <name>Task 2: Create ConflictQueue component</name>
  <files>apps/frontend/src/components/conflicts/ConflictQueue.tsx</files>
  <action>
Create conflict review queue:

Filters:
- Status: Open, Dismissed, Escalated (tabs or dropdown)
- Conflict type: All or specific type
- Severity: All or specific
- Search: Entity name search

List view:
- ConflictAlert cards in list
- Infinite scroll pagination
- Sort by: Date (newest/oldest), Severity, Confidence

Batch actions:
- Select multiple conflicts
- Bulk dismiss with same category
- Link to AI triage for bulk processing

Stats header:
- Open count
- High severity count
- Pending > 7 days count

Empty state:
- "No conflicts to review" when queue empty
- Celebration icon/message
  </action>
  <verify>cd apps/frontend && npx tsc --noEmit</verify>
  <done>ConflictQueue compiles with filtering, batch actions, and stats.</done>
</task>

<task type="auto">
  <name>Task 3: Create EntityTimeline and conflicts page</name>
  <files>
apps/frontend/src/components/conflicts/EntityTimeline.tsx
apps/frontend/src/pages/compliance/conflicts.tsx
  </files>
  <action>
EntityTimeline component per RS.49:

Header:
- Entity name (large)
- Total events count

Timeline:
- Vertical timeline with events
- Each event shows: date, type icon, summary
- Type colors: disclosure (blue), conflict (orange), case (red), approval (green), exclusion (gray)
- Click event to expand details

Event types rendered:
- Disclosure: submitter name, type, value
- Conflict: type, severity, status
- Case: reference number, status
- Approval: approver, decision
- Exclusion: reason, scope

Filters:
- Event type checkboxes
- Date range picker

API: GET /api/v1/conflicts/entity/:name

conflicts.tsx page:
Route: /compliance/conflicts

Layout:
- Left: ConflictQueue (main content)
- Right: EntityTimeline (detail panel, shown when entity selected)

Responsive:
- On mobile, entity timeline opens as modal
  </action>
  <verify>cd apps/frontend && npx tsc --noEmit</verify>
  <done>EntityTimeline and conflicts page compile with full conflict review workflow.</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors
2. Conflict context displays accurately
3. Dismissal captures category and reason
4. Entity timeline shows all related activity
5. Batch dismiss works
</verification>

<success_criteria>
1. Conflict alert shows match context
2. Dismissal creates exclusion when requested
3. Entity timeline aggregates all events
4. Queue filtering works correctly
5. Mobile responsive layout
</success_criteria>

<output>
After completion, create `.planning/phases/09-campaigns-disclosures/09-17-SUMMARY.md`
</output>
