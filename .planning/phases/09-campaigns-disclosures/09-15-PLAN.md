---
phase: 09-campaigns-disclosures
plan: 15
type: execute
wave: 4
depends_on: ["09-13"]
files_modified:
  - apps/frontend/src/components/campaigns/CampaignBuilder.tsx
  - apps/frontend/src/components/campaigns/SegmentBuilder.tsx
  - apps/frontend/src/components/campaigns/ScheduleConfig.tsx
  - apps/frontend/src/pages/campaigns/create.tsx
autonomous: true

must_haves:
  truths:
    - "Segment builder has 'mom test' friendly UX"
    - "Audience preview shows count and sample employees"
    - "Scheduling supports immediate, scheduled, and staggered"
  artifacts:
    - path: "apps/frontend/src/components/campaigns/CampaignBuilder.tsx"
      provides: "Campaign creation wizard"
      exports: ["CampaignBuilder"]
    - path: "apps/frontend/src/components/campaigns/SegmentBuilder.tsx"
      provides: "Mom-test friendly audience targeting"
      exports: ["SegmentBuilder"]
  key_links:
    - from: "apps/frontend/src/components/campaigns/SegmentBuilder.tsx"
      to: "/api/v1/campaigns/audience/preview"
      via: "API calls"
      pattern: "fetch.*audience.*preview"
---

<objective>
Create the campaign builder UI per RS.50-RS.55 - mom-test friendly segment builder, scheduling interface, and reminder configuration.

Purpose: Enable compliance officers to create disclosure campaigns with intuitive audience targeting, flexible scheduling, and configurable reminder sequences. This is the 09-D2 work item from the spec.

Output:
- CampaignBuilder wizard component
- SegmentBuilder with simple and advanced modes
- ScheduleConfig for launch timing
- Campaign creation page
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/09-campaigns-disclosures/09-CONTEXT.md
@.planning/phases/09-campaigns-disclosures/09-13-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SegmentBuilder component</name>
  <files>apps/frontend/src/components/campaigns/SegmentBuilder.tsx</files>
  <action>
Create mom-test friendly segment builder per RS.50:

Simple Mode (default):
- Department picker: Multi-select with checkboxes, searchable
- Location picker: Multi-select with checkboxes, searchable
- "Include their teams" toggle
- Preview count updated live

Advanced Mode (expandable):
- Job title filter
- Manager hierarchy depth slider
- Tenure range (min/max days)
- Custom attributes from HRIS
- Previous campaign response filters
- Exclusion list (specific employee IDs)

UI displays natural language summary:
"Everyone in [Finance, Procurement] at [US locations] who has been here more than [90 days]"
"183 people" with [Preview List] button

Preview List modal:
- Table of matching employees (paginated)
- Columns: Name, Department, Location, Email
- Export preview to CSV

Live updates:
- Debounce 500ms on criteria changes
- Show loading indicator during preview
- Display warning if 0 matches
  </action>
  <verify>cd apps/frontend && npx tsc --noEmit</verify>
  <done>SegmentBuilder compiles with simple/advanced modes and live preview.</done>
</task>

<task type="auto">
  <name>Task 2: Create ScheduleConfig component</name>
  <files>apps/frontend/src/components/campaigns/ScheduleConfig.tsx</files>
  <action>
Create scheduling interface per RS.53:

Launch Options:
1. Immediate - Launch now
2. Scheduled - Pick date/time with timezone
3. Staggered - Configure waves

Staggered rollout config:
- Wave configuration builder
- Add waves with: percentage OR count, date offset
- Visual timeline showing wave distribution
- Example presets: "25% per day", "Pilot first (10%)"

Deadline settings:
- Deadline date picker
- Relative deadline: "14 days after assignment"
- Blackout date warning (show if deadline in blackout)

Reminder sequence builder:
- Add reminder milestones
- For each: days before/after deadline, CC manager toggle, CC HR toggle
- Visual timeline of reminders
- Example presets: "Standard (5, 10, 13 days)", "Aggressive (3, 7, 10, 14)"

Show blackout dates in calendar picker (grayed out, tooltip on hover).
  </action>
  <verify>cd apps/frontend && npx tsc --noEmit</verify>
  <done>ScheduleConfig compiles with launch options, staggered rollout, and reminder builder.</done>
</task>

<task type="auto">
  <name>Task 3: Create CampaignBuilder wizard and page</name>
  <files>
apps/frontend/src/components/campaigns/CampaignBuilder.tsx
apps/frontend/src/pages/campaigns/create.tsx
  </files>
  <action>
CampaignBuilder wizard:

Steps:
1. Basic Info: Name, description, disclosure type, form template selection
2. Audience: SegmentBuilder component
3. Schedule: ScheduleConfig component
4. Review: Summary of all settings, launch button

Navigation:
- Next/Previous buttons
- Step indicator showing progress
- Save draft at any step
- Cancel returns to campaign list

Review step shows:
- Campaign summary card
- Audience count
- Schedule timeline visualization
- Reminder sequence visualization
- Estimated completion date

Launch confirmation:
- "This will send notifications to X employees. Are you sure?"
- Show schedule summary

create.tsx page:
- Route: /campaigns/new
- CampaignBuilder component
- API integration for create and launch

Edit mode (route: /campaigns/:id/edit):
- Load existing campaign if draft
- Disable certain fields if already launched
  </action>
  <verify>cd apps/frontend && npx tsc --noEmit</verify>
  <done>CampaignBuilder wizard and create page compile with full campaign creation flow.</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors
2. Simple mode targeting easy to use
3. Audience preview accurate
4. Staggered rollout visualizes correctly
5. Reminder sequence configurable
</verification>

<success_criteria>
1. Mom can use segment builder (simple mode)
2. Preview shows accurate employee count
3. Blackout dates visible in scheduler
4. Launch confirmation prevents accidents
5. Draft saves preserve progress
</success_criteria>

<output>
After completion, create `.planning/phases/09-campaigns-disclosures/09-15-SUMMARY.md`
</output>
