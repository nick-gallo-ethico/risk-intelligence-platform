---
phase: 14-critical-bug-fixes-navigation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/frontend/src/app/(authenticated)/notifications/page.tsx
  - apps/frontend/src/app/(authenticated)/my-work/page.tsx
autonomous: true

must_haves:
  truths:
    - "Clicking 'View All' in notifications dropdown navigates to /notifications and shows a list of notifications"
    - "Clicking 'View All' on dashboard My Tasks navigates to /my-work and shows the full task queue"
    - "Clicking 'My Tasks' in user dropdown navigates to /my-work and shows tasks"
  artifacts:
    - path: "apps/frontend/src/app/(authenticated)/notifications/page.tsx"
      provides: "Notifications list page"
      min_lines: 50
    - path: "apps/frontend/src/app/(authenticated)/my-work/page.tsx"
      provides: "My Work unified task queue page"
      min_lines: 50
  key_links:
    - from: "notifications/page.tsx"
      to: "/api/v1/notifications"
      via: "useQuery with api.get"
      pattern: "api\\.get.*notifications"
    - from: "my-work/page.tsx"
      to: "/api/v1/my-work"
      via: "useQuery with api.get"
      pattern: "api\\.get.*my-work"
---

<objective>
Create the missing /notifications and /my-work pages to fix 404 errors when clicking "View All" links.

Purpose: These are the two most commonly reached 404s — notifications "View All" in the top nav and "View All Tasks" on the dashboard. Both backend APIs already exist.

Output: Two new page.tsx files in the (authenticated) route group that fetch and display data from existing backend endpoints.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-critical-bug-fixes-navigation/14-RESEARCH.md
@apps/frontend/src/app/(authenticated)/cases/page.tsx
@apps/frontend/src/components/dashboard/my-tasks.tsx
@apps/frontend/src/lib/api.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create /notifications page</name>
  <files>apps/frontend/src/app/(authenticated)/notifications/page.tsx</files>
  <action>
  Create `apps/frontend/src/app/(authenticated)/notifications/page.tsx` following the established page pattern from cases/page.tsx.

The page should:

1. Be a `'use client'` component.

2. Use `useQuery` from `@tanstack/react-query` to fetch notifications:

   ```tsx
   const { data, isLoading, error } = useQuery({
     queryKey: ["notifications", { page, limit }],
     queryFn: async () => {
       const response = await api.get("/notifications", {
         params: { page, limit: 20 },
       });
       return response.data;
     },
   });
   ```

3. Display a page header with title "Notifications" and description.

4. Show a list of notifications with:
   - Icon based on notification type/category (use lucide-react icons: Bell, AlertTriangle, CheckCircle, Info, etc.)
   - Title and message text
   - Timestamp (use date-fns `formatDistanceToNow` or `format`)
   - Read/unread indicator (bold for unread, muted for read)
   - Click handler to mark as read and navigate to the related entity

5. Include a "Mark all as read" button in the header area.

6. Loading state: Show skeleton loading cards while fetching.

7. Empty state: Show "No notifications" message with Bell icon when list is empty.

8. Handle the case where the API returns paginated data with `items` and `total` fields, or a flat array. Check the notifications controller response shape and adapt accordingly. If the response is `{ data: Notification[], total: number }`, use that. If it's just an array, use that directly.

9. Use shadcn/ui components: Card, Badge, Button, Skeleton.

10. Add simple pagination (Previous/Next) at the bottom if total > page size.

Keep the implementation straightforward — this is a list page, not a complex dashboard. Match the visual style of other list pages in the app.
</action>
<verify>
Verify the file exists: `ls apps/frontend/src/app/\(authenticated\)/notifications/page.tsx`
Run `cd apps/frontend && npx tsc --noEmit` to check for TypeScript errors.
</verify>
<done>
/notifications route exists and renders a notifications list page. Fetches from GET /api/v1/notifications. Shows loading state, empty state, and notification items with read/unread styling.
</done>
</task>

<task type="auto">
  <name>Task 2: Create /my-work page</name>
  <files>apps/frontend/src/app/(authenticated)/my-work/page.tsx</files>
  <action>
  Create `apps/frontend/src/app/(authenticated)/my-work/page.tsx` following the established page pattern.

The page should:

1. Be a `'use client'` component.

2. Use `useQuery` to fetch the full task queue:

   ```tsx
   const { data, isLoading } = useQuery({
     queryKey: ["my-work", { filter, page }],
     queryFn: async () => {
       const response = await api.get("/my-work", {
         params: { limit: 50, page },
       });
       return response.data;
     },
   });
   ```

3. Display a page header with title "My Work" and description "All tasks, assignments, and action items across cases, investigations, and campaigns."

4. Show filter tabs or buttons for task categories:
   - All Tasks
   - Cases (filter by source)
   - Investigations
   - Approvals
   - Overdue (highlight overdue items)

5. Each task item should show:
   - Task type icon (use lucide-react: FileText for cases, Search for investigations, CheckSquare for approvals, etc.)
   - Task title and brief description
   - Source entity reference (e.g., "Case #C-2024-00123")
   - Due date with color coding (red if overdue, amber if due today, green if upcoming)
   - Priority badge if available
   - Status badge
   - Click handler navigating to `task.url` (the URL returned by the backend)

6. Loading state: Skeleton cards.

7. Empty state: "You're all caught up! No tasks assigned to you." with CheckCircle icon.

8. The backend `GET /api/v1/my-work` returns `UnifiedTask[]` with fields: `id`, `type`, `title`, `description`, `url`, `dueDate`, `priority`, `status`, `sourceType`, `sourceId`, `sourceReference`. Adapt the UI to these field names.

9. Add simple pagination at the bottom.

10. Use shadcn/ui components: Card, Badge, Button, Tabs/TabsList/TabsTrigger (for category filter), Skeleton.

Match the visual style of existing list pages. The dashboard's my-tasks.tsx component already shows a condensed version — this page is the full version with filtering.
</action>
<verify>
Verify the file exists: `ls apps/frontend/src/app/\(authenticated\)/my-work/page.tsx`
Run `cd apps/frontend && npx tsc --noEmit` to check for TypeScript errors.
</verify>
<done>
/my-work route exists and renders a full task queue page. Fetches from GET /api/v1/my-work. Shows filter tabs, task items with icons/badges/due dates, loading state, empty state, and pagination.
</done>
</task>

</tasks>

<verification>
1. Both page files exist in the (authenticated) route group
2. TypeScript compilation passes: `cd apps/frontend && npx tsc --noEmit`
3. /notifications page imports useQuery and fetches from /notifications endpoint
4. /my-work page imports useQuery and fetches from /my-work endpoint
5. Both pages have loading states (Skeleton) and empty states
6. Task items in /my-work are clickable and navigate to task.url
</verification>

<success_criteria>

- Navigating to /notifications shows a notifications list (no 404)
- Navigating to /my-work shows the full task queue (no 404)
- Both pages use consistent styling with other list pages in the app
- Both pages handle loading and empty states gracefully
  </success_criteria>

<output>
After completion, create `.planning/phases/14-critical-bug-fixes-navigation/14-02-SUMMARY.md`
</output>
