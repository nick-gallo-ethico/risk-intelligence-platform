---
phase: 14-critical-bug-fixes-navigation
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/frontend/src/app/(authenticated)/search/page.tsx
  - apps/frontend/src/app/(authenticated)/profile/page.tsx
  - apps/frontend/src/components/cases/form-sections/basic-info-section.tsx
autonomous: true

must_haves:
  truths:
    - "Global search bar submits and navigates to /search?q=term showing search results"
    - "Clicking 'My Profile' in user dropdown navigates to a working page (not 404)"
    - "Opening 'Create Case' form does not throw runtime Select.Item error"
    - "Category dropdowns in case creation form allow selecting 'None' without error"
  artifacts:
    - path: "apps/frontend/src/app/(authenticated)/search/page.tsx"
      provides: "Search results page with unified search"
      min_lines: 50
    - path: "apps/frontend/src/app/(authenticated)/profile/page.tsx"
      provides: "Profile page (redirect to settings or minimal profile)"
      min_lines: 5
    - path: "apps/frontend/src/components/cases/form-sections/basic-info-section.tsx"
      provides: "Fixed SelectItem with sentinel value instead of empty string"
      contains: "__none__"
  key_links:
    - from: "search/page.tsx"
      to: "/api/v1/search/unified"
      via: "useQuery with api.get"
      pattern: "api\\.get.*search"
    - from: "basic-info-section.tsx"
      to: "SelectItem"
      via: "sentinel value pattern"
      pattern: "__none__"
---

<objective>
Create the missing /search and /profile pages, and fix the Radix Select runtime error in case creation form.

Purpose: The search bar is prominently visible but completely broken. The profile link 404s. The "Create Case" form crashes with a runtime error. These three fixes eliminate the most jarring broken interactions.

Output: New search results page, profile redirect page, and fixed SelectItem values in basic-info-section.tsx.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-critical-bug-fixes-navigation/14-RESEARCH.md
@apps/frontend/src/components/layout/top-nav.tsx
@apps/frontend/src/components/cases/form-sections/basic-info-section.tsx
@apps/frontend/src/app/(authenticated)/cases/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create /search results page and /profile redirect</name>
  <files>apps/frontend/src/app/(authenticated)/search/page.tsx, apps/frontend/src/app/(authenticated)/profile/page.tsx</files>
  <action>
  **Search results page: `apps/frontend/src/app/(authenticated)/search/page.tsx`**

Create a search results page that reads the `q` query parameter and calls the unified search API.

1. Be a `'use client'` component.

2. Read the query parameter:

   ```tsx
   import { useSearchParams } from "next/navigation";
   const searchParams = useSearchParams();
   const query = searchParams.get("q") ?? "";
   ```

3. Fetch search results using useQuery:

   ```tsx
   const { data, isLoading } = useQuery({
     queryKey: ["search", query],
     queryFn: async () => {
       const response = await api.get("/search/unified", {
         params: { q: query, limit: 50 },
       });
       return response.data;
     },
     enabled: !!query,
   });
   ```

4. Display page header showing "Search results for '{query}'" with the count of results.

5. Render results grouped by entity type (Cases, People, Policies, Investigations, etc.):
   - Each result shows: entity type badge, title/name, brief excerpt/description, link to entity detail page
   - Group sections with headers: "Cases (N)", "People (N)", etc.
   - Each result is clickable, navigating to the entity URL (e.g., `/cases/{id}`, `/investigations/{id}`, `/policies/{id}`)

6. The unified search API likely returns something like `{ cases: [], people: [], policies: [], total: N }` or `{ results: [{ type, id, title, ... }] }`. Check the search controller response shape and adapt. If it returns a flat array with `entityType` field, group client-side.

7. Empty state when no query: "Enter a search term above to find cases, people, policies, and more."
8. Empty state when query has no results: "No results found for '{query}'. Try a different search term."
9. Loading state: Skeleton cards grouped by section.

10. Include a search input at the top of the page (pre-filled with query) that allows refining the search without going back to the top nav. On submit, update the URL query param.

Use shadcn/ui: Card, Badge, Input, Button, Skeleton.

**Profile redirect: `apps/frontend/src/app/(authenticated)/profile/page.tsx`**

Create a simple redirect page:

```tsx
import { redirect } from "next/navigation";
export default function ProfilePage() {
  redirect("/settings");
}
```

This immediately redirects /profile to /settings since there's no dedicated profile page. Use Next.js server-side redirect (no 'use client' needed).
</action>
<verify>
Verify files exist:
`ls apps/frontend/src/app/\(authenticated\)/search/page.tsx`
`ls apps/frontend/src/app/\(authenticated\)/profile/page.tsx`
Run `cd apps/frontend && npx tsc --noEmit` to check for TypeScript errors.
</verify>
<done>
/search route exists and displays grouped search results from the unified search API. /profile route exists and redirects to /settings. Both routes respond without 404.
</done>
</task>

<task type="auto">
  <name>Task 2: Fix SelectItem empty string values in case creation form</name>
  <files>apps/frontend/src/components/cases/form-sections/basic-info-section.tsx</files>
  <action>
  Fix the Radix UI Select runtime error caused by empty string values in SelectItem components.

1. Find ALL instances of `<SelectItem value="">` in basic-info-section.tsx. Research identified two at lines ~185 and ~212 (Primary Category and Secondary Category selects).

2. Replace each empty string value with a sentinel value:

   ```tsx
   // BEFORE:
   <SelectItem value="">None</SelectItem>

   // AFTER:
   <SelectItem value="__none__">None</SelectItem>
   ```

3. Update the corresponding `onValueChange` handlers to convert the sentinel back to empty string:

   ```tsx
   // BEFORE (if it exists):
   onValueChange={(value) => setValue('primaryCategoryId', value)}

   // AFTER:
   onValueChange={(value) => setValue('primaryCategoryId', value === '__none__' ? '' : value)}
   ```

4. Update the Select `value` prop to convert empty string back to sentinel for display:

   ```tsx
   // BEFORE:
   value={primaryCategoryId}

   // AFTER:
   value={primaryCategoryId === '' || !primaryCategoryId ? '__none__' : primaryCategoryId}
   ```

5. Apply the same pattern to ALL Select components in the file that have empty-string SelectItem values. Check for other form sections too — search the entire `form-sections/` directory for `value=""` inside SelectItem:

   ```bash
   grep -rn 'SelectItem.*value=""' apps/frontend/src/components/cases/form-sections/
   ```

   Fix ALL occurrences, not just the two known ones.

6. Do NOT change the form's internal data model. The form should still store empty string `""` for "no selection" — only the Select component's value/display uses the sentinel.

IMPORTANT: Radix UI Select requires ALL SelectItem `value` props to be non-empty strings. The sentinel `"__none__"` is a UI-only concern; the form state continues to use `""` for null/no-selection.
</action>
<verify>
Run `grep -n 'SelectItem.*value=""' apps/frontend/src/components/cases/form-sections/basic-info-section.tsx` — should return zero results.
Run `grep -n '__none__' apps/frontend/src/components/cases/form-sections/basic-info-section.tsx` — should find the sentinel values.
Run `cd apps/frontend && npx tsc --noEmit` to verify no TypeScript errors.
</verify>
<done>
No SelectItem components have empty string values. All "None" options use "**none**" sentinel. onValueChange handlers convert sentinel back to empty string. Create Case form opens without Radix UI runtime errors.
</done>
</task>

</tasks>

<verification>
1. All three page files exist in the (authenticated) route group
2. TypeScript compilation passes: `cd apps/frontend && npx tsc --noEmit`
3. /search page reads ?q= param and calls unified search API
4. /profile page redirects to /settings
5. No `SelectItem value=""` patterns remain in basic-info-section.tsx
6. "__none__" sentinel value used consistently with bidirectional conversion
</verification>

<success_criteria>

- Global search from top nav navigates to /search?q=... and shows results
- /profile redirects to /settings (no 404)
- "Create Case" form opens without runtime errors
- Category "None" selection works correctly without console errors
  </success_criteria>

<output>
After completion, create `.planning/phases/14-critical-bug-fixes-navigation/14-03-SUMMARY.md`
</output>
