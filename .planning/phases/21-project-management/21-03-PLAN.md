---
phase: 21-project-management
plan: 03
type: execute
wave: 3
depends_on: ["21-02"]
files_modified:
  - apps/frontend/src/types/project.ts
  - apps/frontend/src/lib/views/configs/projects.config.ts
  - apps/frontend/src/lib/views/configs/index.ts
  - apps/frontend/src/hooks/views/useProjectsView.ts
  - apps/frontend/src/hooks/views/index.ts
  - apps/frontend/src/hooks/use-milestones.ts
  - apps/frontend/src/app/(authenticated)/projects/page.tsx
autonomous: true

must_haves:
  truths:
    - "Projects page shows table view with sortable columns via saved views system"
    - "Projects page shows board/Kanban view with drag-to-move cards between status lanes"
    - "Users can switch between table and board views"
    - "Project list has filters for status, category, owner"
    - "Clicking a project navigates to the project detail page"
    - "New Project button opens create dialog"
  artifacts:
    - path: "apps/frontend/src/types/project.ts"
      provides: "TypeScript types for Project, ProjectTask, ProjectGroup"
    - path: "apps/frontend/src/lib/views/configs/projects.config.ts"
      provides: "Saved views module configuration for projects"
    - path: "apps/frontend/src/hooks/views/useProjectsView.ts"
      provides: "Data fetching hook for projects saved views"
    - path: "apps/frontend/src/app/(authenticated)/projects/page.tsx"
      provides: "Full project list page with saved views"
  key_links:
    - from: "useProjectsView.ts"
      to: "/api/v1/projects"
      via: "React Query fetch"
      pattern: "apiClient.*projects"
    - from: "projects/page.tsx"
      to: "SavedViewProvider"
      via: "Wraps page content"
      pattern: "SavedViewProvider"
---

<objective>
Replace the existing basic project list page with a full Monday.com-style project list using the saved views system. Implements table view (sortable, filterable columns) and board/Kanban view (drag cards between status lanes) with the same SavedViewProvider pattern used by Cases, Investigations, Policies, etc.

Purpose: Give users a powerful project overview with the same UX patterns they know from other modules.
Output: Rewritten projects page with saved views, table/board toggle, filtering, and create dialog.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-project-management/21-02-SUMMARY.md
@apps/frontend/src/lib/views/configs/cases.config.ts
@apps/frontend/src/hooks/views/useCasesView.ts
@apps/frontend/src/app/(authenticated)/projects/page.tsx
@apps/frontend/src/hooks/use-milestones.ts
@apps/frontend/src/types/milestone.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TypeScript types and view config for projects</name>
  <files>
    apps/frontend/src/types/project.ts
    apps/frontend/src/lib/views/configs/projects.config.ts
    apps/frontend/src/lib/views/configs/index.ts
    apps/frontend/src/hooks/use-milestones.ts
  </files>
  <action>
**Create `types/project.ts`** with TypeScript types matching the backend models:

```typescript
// Project status matching MilestoneStatus enum
export type ProjectStatus =
  | "NOT_STARTED"
  | "IN_PROGRESS"
  | "AT_RISK"
  | "COMPLETED"
  | "CANCELLED";

// Project category matching MilestoneCategory enum
export type ProjectCategory =
  | "AUDIT"
  | "INVESTIGATION"
  | "CAMPAIGN"
  | "PROJECT"
  | "TRAINING"
  | "REMEDIATION"
  | "OTHER";

export type ProjectTaskStatus =
  | "NOT_STARTED"
  | "IN_PROGRESS"
  | "STUCK"
  | "DONE"
  | "CANCELLED";
export type ProjectTaskPriority = "LOW" | "MEDIUM" | "HIGH" | "CRITICAL";

export interface Project {
  id: string;
  name: string;
  description?: string;
  category: ProjectCategory;
  status: ProjectStatus;
  targetDate: string;
  completedAt?: string;
  progressPercent: number;
  totalItems: number;
  completedItems: number;
  owner?: { id: string; name: string; email: string };
  ownerId?: string;
  taskCount?: number;
  completedTaskCount?: number;
  createdAt: string;
  updatedAt: string;
}

export interface ProjectGroup {
  id: string;
  name: string;
  color?: string;
  sortOrder: number;
  isCollapsed: boolean;
  tasks?: ProjectTask[];
}

export interface ProjectTask {
  id: string;
  title: string;
  description?: string;
  status: ProjectTaskStatus;
  priority: ProjectTaskPriority;
  assignee?: { id: string; name: string; email: string };
  assigneeId?: string;
  startDate?: string;
  dueDate?: string;
  completedAt?: string;
  sortOrder: number;
  groupId?: string;
  group?: { id: string; name: string };
  parentTaskId?: string;
  subtaskCount?: number;
  customFields?: Record<string, unknown>;
  createdAt: string;
  updatedAt: string;
}

export interface ProjectColumn {
  id: string;
  name: string;
  type: string;
  settings?: Record<string, unknown>;
  sortOrder: number;
  width?: number;
  isRequired: boolean;
}

export interface ProjectTemplate {
  id: string;
  name: string;
  description?: string;
  category: ProjectCategory;
  isSystem: boolean;
  templateData: unknown;
}
```

**Create `lib/views/configs/projects.config.ts`** following the cases.config.ts pattern:

- `moduleType: "PROJECTS"`
- `entityName: { singular: "Project", plural: "Projects" }`
- `primaryColumnId: "name"`
- `endpoints: { list: "/projects", export: "/projects/export", bulk: "/projects/bulk", single: (id) => "/projects/${id}" }`
- Property groups: "core" (Core Fields), "progress" (Progress), "dates" (Dates), "assignment" (Assignment)
- Columns:
  - name (Core, sortable, default visible, width 250, frozen)
  - status (Core, sortable, default visible, width 130) - with status badge rendering
  - category (Core, sortable, default visible, width 130)
  - progressPercent (Progress, default visible, width 120) - render as progress bar
  - taskCount (Progress, width 100)
  - completedTaskCount (Progress, width 120)
  - owner (Assignment, default visible, width 150) - render as avatar + name
  - targetDate (Dates, sortable, default visible, width 130) - render as date
  - completedAt (Dates, width 130)
  - createdAt (Dates, width 130)
  - description (Core, width 200)
- Board config:
  - defaultGroupByField: "status"
  - columns matching MilestoneStatus: NOT_STARTED (gray), IN_PROGRESS (blue), AT_RISK (amber), COMPLETED (green), CANCELLED (red)
  - cardTitleField: "name"
  - cardFields: ["category", "progressPercent", "owner", "targetDate"]
- Quick filters: status (multi-select), category (multi-select), owner (people picker)
- Bulk actions: "Change Status", "Change Owner", "Delete"
- Status options with colors for NOT_STARTED, IN_PROGRESS, AT_RISK, COMPLETED, CANCELLED
- Category options for AUDIT, INVESTIGATION, CAMPAIGN, PROJECT, TRAINING, REMEDIATION, OTHER

**Update `lib/views/configs/index.ts`** to export PROJECTS_VIEW_CONFIG.

**Fix `hooks/use-milestones.ts`**: Update the endpoint from `/milestones` to `/projects` to match the actual backend controller route. This fixes the existing API mismatch documented in research.
</action>
<verify>
`cd apps/frontend && npx tsc --noEmit` should pass.
PROJECTS_VIEW_CONFIG exported from configs/index.ts.
</verify>
<done>TypeScript types match backend models. View config follows established pattern with columns, board config, filters. Milestone hooks endpoint mismatch fixed.</done>
</task>

<task type="auto">
  <name>Task 2: Create useProjectsView hook and rewrite projects page</name>
  <files>
    apps/frontend/src/hooks/views/useProjectsView.ts
    apps/frontend/src/hooks/views/index.ts
    apps/frontend/src/app/(authenticated)/projects/page.tsx
  </files>
  <action>
**Create `hooks/views/useProjectsView.ts`** following the useCasesView.ts pattern:

- Import PROJECTS_VIEW_CONFIG and useSavedViewContext
- Define Project interface extending Record<string, unknown> with all project fields
- ProjectsResponse: { data: Project[]; total: number; page: number; pageSize: number }
- `useProjectsView()` hook:
  - Gets state from useSavedViewContext (currentView, filters, sort, page, pageSize)
  - useQuery for fetching projects from "/projects" with filters, sort, pagination mapped from view state
  - Bulk action handler mutations (delete, change status, change owner)
  - Return: { data, total, isLoading, error, handleBulkAction, refetch }
- Handle filter conversion from saved view filter groups to API query params (status, category, ownerId, search, sortBy, sortOrder, offset, limit)

**Update `hooks/views/index.ts`** to export useProjectsView.

**Rewrite `app/(authenticated)/projects/page.tsx`** completely:

Replace the current basic card list with the full saved views pattern:

```tsx
"use client";

import { SavedViewProvider } from "@/contexts/SavedViewContext";
import { PROJECTS_VIEW_CONFIG } from "@/lib/views/configs/projects.config";
import { ViewTabsBar } from "@/components/views/ViewTabsBar";
import { ViewToolbar } from "@/components/views/ViewToolbar";
import { QuickFiltersRow } from "@/components/views/QuickFiltersRow";
import { DataTable } from "@/components/views/DataTable";
import { BoardView } from "@/components/views/BoardView";
import { ColumnSelectionModal } from "@/components/views/ColumnSelectionModal";
import { AdvancedFiltersPanel } from "@/components/views/AdvancedFiltersPanel";
import { useProjectsView } from "@/hooks/views/useProjectsView";
import { useSavedViewContext } from "@/hooks/views/useSavedViewContext";
// ... create project dialog components

function ProjectsContent() {
  const { viewMode } = useSavedViewContext();
  const { data, total, isLoading, handleBulkAction } = useProjectsView();

  // Render DataTable for 'table' mode, BoardView for 'board' mode
  // Row click navigates to /projects/[id]
  // New Project button opens CreateProjectDialog
}

export default function ProjectsPage() {
  return (
    <SavedViewProvider config={PROJECTS_VIEW_CONFIG}>
      <div className="flex flex-col h-full">
        <ViewTabsBar />
        <ViewToolbar />
        <QuickFiltersRow />
        <ProjectsContent />
        <ColumnSelectionModal />
        <AdvancedFiltersPanel />
      </div>
    </SavedViewProvider>
  );
}
```

Add a `CreateProjectDialog` component inline or in a separate file within the page directory:

- Dialog with form fields: name, description, category (select), targetDate (date picker), ownerId (user picker)
- Optional: "From Template" tab that lists templates and applies selected one
- On submit: POST to /projects, then refetch list
- Use react-hook-form + zod for validation
- Use shadcn/ui Dialog, Input, Select, Button components

Clicking a project row/card navigates to `/projects/${project.id}` using router.push.
</action>
<verify>
`cd apps/frontend && npx tsc --noEmit` passes.
Projects page renders with SavedViewProvider wrapper.
Table and board view modes work.
</verify>
<done>Projects page fully rewritten with saved views system. Table view shows sortable columns. Board view shows Kanban cards by status. Create dialog works. Clicking project navigates to detail.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes from apps/frontend
- Projects page renders at /projects
- Table view shows columns: name, status, category, progress, owner, target date
- Board view shows cards grouped by status with drag-to-move
- Quick filters for status, category, owner work
- Create project dialog creates new project
- Clicking project navigates to /projects/[id]
</verification>

<success_criteria>

- Projects list page uses SavedViewProvider pattern matching other modules
- Both table and board views functional
- Filters work (status, category, owner)
- New project creation works
- Navigation to detail page works
- API endpoint mismatch (milestones vs projects) fixed
  </success_criteria>

<output>
After completion, create `.planning/phases/21-project-management/21-03-SUMMARY.md`
</output>
