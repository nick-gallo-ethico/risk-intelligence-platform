---
phase: 21-project-management
plan: 05
type: execute
wave: 5
depends_on: ["21-03", "21-04"]
files_modified:
  - apps/frontend/src/components/projects/ProjectBoardView.tsx
  - apps/frontend/src/components/projects/ProjectTimelineView.tsx
  - apps/frontend/src/components/projects/ProjectTemplateSelector.tsx
  - apps/frontend/src/components/projects/GanttChart.tsx
  - apps/frontend/src/app/(authenticated)/projects/[id]/page.tsx
  - apps/frontend/src/app/(authenticated)/projects/page.tsx
autonomous: true

must_haves:
  truths:
    - "Kanban board view within project detail shows tasks grouped by status with drag-to-move"
    - "Timeline/Gantt view within project detail shows tasks on a time axis with start/end dates"
    - "Project template selector allows creating projects from built-in templates"
    - "All three views (table, board, timeline) are switchable on project detail page"
  artifacts:
    - path: "apps/frontend/src/components/projects/ProjectBoardView.tsx"
      provides: "Kanban board for tasks within a single project"
    - path: "apps/frontend/src/components/projects/ProjectTimelineView.tsx"
      provides: "Gantt-style timeline for project tasks"
    - path: "apps/frontend/src/components/projects/ProjectTemplateSelector.tsx"
      provides: "Template selection UI for new project creation"
  key_links:
    - from: "ProjectBoardView.tsx"
      to: "use-project-detail.ts"
      via: "Hook for task data and mutations"
      pattern: "useProjectTasks|useBulkUpdateTasks"
    - from: "ProjectTimelineView.tsx"
      to: "GanttChart.tsx"
      via: "Wraps existing GanttChart with project task data"
      pattern: "GanttChart"
---

<objective>
Add Kanban board view and timeline/Gantt view to the project detail page. Enhance the create project dialog with template selection. This completes the three-view experience: table (Plan 04), board, and timeline.

Purpose: Provide multiple visual representations of project work - table for detail editing, board for status flow, timeline for scheduling.
Output: Board and timeline views on project detail, template selector on create dialog.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-project-management/21-03-SUMMARY.md
@.planning/phases/21-project-management/21-04-SUMMARY.md
@apps/frontend/src/components/projects/GanttChart.tsx
@apps/frontend/src/components/views/BoardView.tsx
@apps/frontend/src/types/project.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build project board view and timeline view</name>
  <files>
    apps/frontend/src/components/projects/ProjectBoardView.tsx
    apps/frontend/src/components/projects/ProjectTimelineView.tsx
    apps/frontend/src/components/projects/GanttChart.tsx
    apps/frontend/src/app/(authenticated)/projects/[id]/page.tsx
  </files>
  <action>
**ProjectBoardView.tsx** - Kanban board for tasks within a project:

This is a project-specific board (not the module-level board from saved views). It shows columns for each ProjectTaskStatus:

- NOT_STARTED (gray header)
- IN_PROGRESS (blue header)
- STUCK (red header)
- DONE (green header)
- CANCELLED (gray header, collapsed by default)

Implementation using @dnd-kit:

- DndContext with closestCorners collision detection
- Each status column is a SortableContext with useDroppable
- Each task card is useDraggable
- On drag end: if dragged to different column, call useBulkUpdateTasks to change task status. If same column, call useReorderTasks.
- DragOverlay shows a preview card during drag

Task cards display:

- Title (bold)
- Priority icon (colored)
- Assignee avatar (small circle)
- Due date (if set, colored red if overdue)
- Subtask progress (e.g., "2/5" if subtasks exist)
- Group color indicator (thin left border matching group color)

Column header shows:

- Status name with colored dot
- Task count
- "+" button to add task in that status

Click on a card opens the TaskDetailPanel (same one from Plan 04). Use the same selectedTaskId state mechanism in the parent page.

**ProjectTimelineView.tsx** - Gantt-style timeline:

Wraps and adapts the existing GanttChart component to work with ProjectTask data:

- Maps ProjectTask[] to the format GanttChart expects (items with start, end, label, status, progress)
- Tasks without startDate use createdAt as start; tasks without dueDate don't show a bar (show as milestone dot)
- Color bars by task status (matching board colors)
- Groups tasks by their ProjectGroup for the left-side label column
- Show today indicator line
- Zoom controls: week, month, quarter (already in GanttChart)

If GanttChart doesn't accept the data shape needed, extend it:

- Add a `tasks` prop alternative to the milestone-based data shape
- Or create a data mapper function that converts ProjectTask[] to the existing GanttChart data format
- Keep backward compat - don't break existing MilestoneTimeline usage

Click on a task bar opens TaskDetailPanel.

**Update project detail page** (`[id]/page.tsx`):

- Replace the placeholder board and timeline views with the real components
- Wire up view mode switching between 'table', 'board', 'timeline'
- Pass shared state: selectedTaskId, project data, mutation hooks
- Store viewMode in URL search param `?view=table|board|timeline` for persistence
  </action>
  <verify>
  `cd apps/frontend && npx tsc --noEmit` passes.
  Board view renders with task cards in status columns.
  Timeline view renders task bars on time axis.
  Drag-drop on board changes task status.
  </verify>
  <done>Board view with drag-to-move task cards between status columns. Timeline view shows tasks on Gantt chart. Both integrated into project detail page with view switching.</done>
  </task>

<task type="auto">
  <name>Task 2: Add project template selector to create dialog</name>
  <files>
    apps/frontend/src/components/projects/ProjectTemplateSelector.tsx
    apps/frontend/src/app/(authenticated)/projects/page.tsx
  </files>
  <action>
**ProjectTemplateSelector.tsx**:

A component used within the CreateProjectDialog from Plan 03:

- Fetches templates from `GET /project-templates` via React Query
- Displays as a grid of template cards
- Each card shows: template name, description, category badge, "System" badge if isSystem
- Cards are selectable (radio-style - one at a time, or "Blank Project" option)
- Selected template highlights with border
- When a template is selected:
  - The category field auto-fills from template
  - A preview section shows what groups and columns will be created
  - The "From Template" tab is active

**Update CreateProjectDialog in projects/page.tsx**:

- Add two tabs to the dialog: "Blank Project" and "From Template"
- "Blank Project" tab: existing form (name, description, category, targetDate, ownerId)
- "From Template" tab: ProjectTemplateSelector + name, targetDate, ownerId fields
  - On submit: calls `POST /project-templates/${templateId}/apply` with { name, targetDate, ownerId }
  - On success: navigates to the new project detail page
- Use shadcn/ui Tabs within the Dialog for the two modes

Templates to expect from backend (seeded in Plan 01):

- New Client Implementation
- Annual Policy Review
- Compliance Audit Prep
- Investigation Project
- Training Rollout
- Disclosure Campaign
  </action>
  <verify>
  `cd apps/frontend && npx tsc --noEmit` passes.
  Create dialog shows two tabs: Blank Project and From Template.
  Template cards display correctly.
  Applying template creates project and navigates to detail.
  </verify>
  <done>Project template selector shows available templates in a card grid. Create dialog has Blank/Template tabs. Applying template creates fully structured project.</done>
  </task>

</tasks>

<verification>
- `npx tsc --noEmit` passes from apps/frontend
- Three view modes work on project detail: table, board, timeline
- Board drag-drop changes task status
- Timeline shows task bars with date ranges
- Template selector works in create dialog
- View mode persists in URL
</verification>

<success_criteria>

- Kanban board within project shows tasks by status with drag-to-move
- Gantt/timeline view shows task scheduling
- Project templates available for quick project creation
- All three views share the same task detail panel
- View mode switchable and URL-persisted
  </success_criteria>

<output>
After completion, create `.planning/phases/21-project-management/21-05-SUMMARY.md`
</output>
