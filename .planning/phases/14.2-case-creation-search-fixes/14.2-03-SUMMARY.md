---
phase: 14.2-case-creation-search-fixes
plan: 03
subsystem: verification
tags:
  - human-verify
  - checkpoint
  - categories
  - search
dependency-graph:
  requires:
    - 14.2-01
    - 14.2-02
  provides:
    - Phase 14.2 verified end-to-end
  affects: []
tech-stack:
  added: []
  patterns: []
key-files:
  created: []
  modified:
    - apps/frontend/src/components/cases/form-sections/basic-info-section.tsx
    - apps/frontend/src/lib/validations/case-schema.ts
decisions:
  - id: 14.2-03-D1
    title: Fix category ID passthrough in form submission
    choice: Map primaryCategoryId and secondaryCategoryId from form values to API payload
    rationale: Form collected values but submission handler was not including them in the POST body
  - id: 14.2-03-D2
    title: Align ReporterType enum with backend Prisma schema
    choice: Update frontend enum values to match backend exactly (ANONYMOUS, CONFIDENTIAL, IDENTIFIED)
    rationale: Enum mismatch caused case creation to fail with validation error
metrics:
  duration: 15m
  completed: 2026-02-10
---

# Phase 14.2 Plan 03: Verification Checkpoint Summary

**One-liner:** Human verification of category dropdowns and unified search — two blocking issues found and fixed during verification.

## Verification Results

### Test 1: Category Dropdown in Case Creation

| Check                                          | Result           |
| ---------------------------------------------- | ---------------- |
| Category dropdown appears in form              | PASS (after fix) |
| Dropdown contains 7 level-0 categories         | PASS             |
| Subcategory populates on category selection    | PASS             |
| Subcategory resets on category change          | PASS             |
| Created case has primaryCategoryId persisted   | PASS (after fix) |
| Created case has secondaryCategoryId persisted | PASS (after fix) |

### Test 2: Unified Search

| Check                                   | Result |
| --------------------------------------- | ------ |
| Search for "harassment" returns results | PASS   |
| Search for case numbers returns results | PASS   |
| Click result navigates to case detail   | PASS   |

### Test 3: Edge Cases

| Check                                | Result |
| ------------------------------------ | ------ |
| Category change resets subcategory   | PASS   |
| Search with no results shows message | PASS   |
| Empty search shows no error          | PASS   |

## Issues Found & Fixed During Verification

### Issue 1: Category IDs not passed in form submission

- **Found during:** Test 1 — case created but no category saved
- **Root cause:** `basic-info-section.tsx` collected category values in form state but the submission handler did not include `primaryCategoryId` and `secondaryCategoryId` in the POST body to `/api/v1/cases`
- **Fix:** Updated form submission to map category fields into API payload
- **Commit:** f47301f

### Issue 2: ReporterType enum mismatch

- **Found during:** Test 1 — case creation failed with validation error
- **Root cause:** Frontend `case-schema.ts` used different enum values than backend Prisma schema for reporter type (e.g., `anonymous` vs `ANONYMOUS`)
- **Fix:** Aligned frontend enum values to match backend Prisma schema exactly: `ANONYMOUS`, `CONFIDENTIAL`, `IDENTIFIED`
- **Commit:** 166fc20

## Phase 14.2 Success Criteria Verification

| #   | Criterion                                                              | Status |
| --- | ---------------------------------------------------------------------- | ------ |
| 1   | Case creation form shows Category dropdown with all level-0 categories | PASS   |
| 2   | Subcategory dropdown populates based on selected category              | PASS   |
| 3   | Created cases have correct primaryCategoryId and secondaryCategoryId   | PASS   |
| 4   | Unified search returns results for case content (e.g., "harassment")   | PASS   |
| 5   | Unified search returns results for case numbers (e.g., "CASE-2025")    | PASS   |

**All 5 success criteria verified.** Phase 14.2 complete.

## Commits

| Hash    | Message                                                          |
| ------- | ---------------------------------------------------------------- |
| f47301f | fix(14.2-03): pass category IDs in case creation form submission |
| 166fc20 | fix(14.2-03): align ReporterType enum with backend Prisma schema |
