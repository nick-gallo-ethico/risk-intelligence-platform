---
phase: 06-case-management
plan: 16
type: execute
wave: 5
depends_on: ["06-12", "06-13", "06-14", "06-15"]
files_modified:
  - apps/frontend/src/App.tsx
  - apps/frontend/src/routes/index.tsx
  - apps/backend/src/app.module.ts
autonomous: false

must_haves:
  truths:
    - "All Case Management routes registered and navigable"
    - "All backend modules imported into AppModule"
    - "End-to-end flow works: create case, apply template, complete checklist items"
    - "Anonymous messaging relay preserves reporter anonymity"
  artifacts:
    - path: "apps/frontend/src/routes/index.tsx"
      provides: "Complete route registration"
    - path: "apps/backend/src/app.module.ts"
      provides: "All Phase 6 modules imported"
  key_links:
    - from: "App.tsx"
      to: "routes/index.tsx"
      via: "router import"
      pattern: "createBrowserRouter"
---

<objective>
Wire all Phase 6 components together, register routes, verify end-to-end functionality, and perform human verification of critical flows.

Purpose: Integration ensures all individual components work together as a cohesive Case Management system before moving to next phase.

Output: Complete route registration, module wiring, verified end-to-end flows
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/06-case-management/06-01-SUMMARY.md
@.planning/phases/06-case-management/06-12-SUMMARY.md
@.planning/phases/06-case-management/06-13-SUMMARY.md
@.planning/phases/06-case-management/06-14-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Register All Frontend Routes</name>
  <files>
    apps/frontend/src/routes/index.tsx
    apps/frontend/src/App.tsx
  </files>
  <action>
Update routes/index.tsx to include all Phase 6 routes:

```typescript
// Case Management routes
{
  path: '/cases',
  element: <CaseListPage />,
},
{
  path: '/cases/:caseId',
  element: <CaseDetailPage />,
},
{
  path: '/cases/:caseId/investigations/:investigationId',
  element: <InvestigationDetailPage />,
},
{
  path: '/investigations',
  element: <InvestigationListPage />,  // If exists
},
{
  path: '/remediation',
  element: <RemediationListPage />,  // If exists
},
{
  path: '/remediation/:planId',
  element: <RemediationDetailPage />,  // If exists
},
```

Update App.tsx to:
1. Include ShortcutsProvider wrapper
2. Include CommandPalette at root level
3. Include ShortcutsHelpDialog at root level
4. Ensure all context providers properly nested
  </action>
  <verify>All routes navigable. No console errors on navigation.</verify>
  <done>All Case Management routes registered and functional.</done>
</task>

<task type="auto">
  <name>Task 2: Wire Backend Modules</name>
  <files>apps/backend/src/app.module.ts</files>
  <action>
Verify all Phase 6 modules imported in AppModule:

```typescript
import { InvestigationTemplateModule } from './modules/investigations/templates/template.module';
import { InvestigationInterviewModule } from './modules/investigations/interviews/interview.module';
import { InvestigationChecklistModule } from './modules/investigations/checklists/checklist.module';
import { RemediationModule } from './modules/remediation/remediation.module';
import { SavedViewsModule } from './modules/saved-views/saved-views.module';
import { CustomPropertiesModule } from './modules/custom-properties/custom-properties.module';
import { ActivityModule } from './modules/activity/activity.module';
import { MessagingModule } from './modules/messaging/messaging.module';

@Module({
  imports: [
    // ... existing modules
    InvestigationTemplateModule,
    InvestigationInterviewModule,
    InvestigationChecklistModule,
    RemediationModule,
    SavedViewsModule,
    CustomPropertiesModule,
    ActivityModule,
    MessagingModule,
    // SearchModule already exists, UnifiedSearchService added to it
  ],
})
export class AppModule {}
```

Run `npm run build` in apps/backend to verify all modules compile.
  </action>
  <verify>`npm run build` in apps/backend succeeds with no missing imports.</verify>
  <done>All Phase 6 backend modules wired into AppModule.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Case Management system including:
- Investigation templates with checklist sections
- Template assignment by category
- Checklist progress tracking with item completion
- Structured interview recording
- Remediation plans with step assignment
- Anonymous message relay
- Saved views and custom properties
- Case list with advanced filtering
- Case detail with linked RIUs
- Investigation detail with checklist panel
- Keyboard shortcuts and command palette
  </what-built>
  <how-to-verify>
**Test 1: Investigation Template Flow**
1. Navigate to Cases list
2. Open a Case detail page
3. Create new Investigation
4. Apply an investigation template
5. Verify checklist sections and items appear
6. Complete a checklist item with notes
7. Verify progress bar updates

**Test 2: Remediation Flow**
1. From Case detail, create Remediation Plan
2. Add remediation steps with assignees
3. Verify step dependencies work (can't complete step B before A if dependent)
4. Mark a step complete with notes
5. Verify overall progress updates

**Test 3: Anonymous Communication**
1. Find a Case with linked RIU that has reporter contact
2. Send a message from the Case message thread
3. Verify message appears without revealing investigator identity to reporter
4. Check that PII warning appears if message contains potential identifiers

**Test 4: Saved Views**
1. On Case list, apply filters (status, category, severity)
2. Save current filters as a view
3. Clear filters, then apply saved view
4. Verify filters restored correctly

**Test 5: Keyboard Shortcuts**
1. Press Cmd+K anywhere - command palette should open
2. Press ? - shortcuts help should show
3. On Case list, press J/K - focus should move between rows
4. Press Enter on focused row - should open Case detail

**Test 6: Custom Properties**
1. (If admin) Define a custom property on Cases (e.g., "External Case ID")
2. On Case detail, verify custom field appears
3. Enter a value, save
4. Verify value persists on reload
  </how-to-verify>
  <resume-signal>Type "approved" if all flows work correctly, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
- [ ] All frontend routes accessible without errors
- [ ] All backend modules compile and load
- [ ] Investigation template -> checklist flow works end-to-end
- [ ] Remediation plan creation and step tracking works
- [ ] Anonymous messaging preserves reporter identity
- [ ] Saved views persist and restore filters
- [ ] Keyboard shortcuts work globally
</verification>

<success_criteria>
1. Complete navigation between all Case Management pages
2. Investigation template workflow: select, apply, track progress
3. Remediation workflow: create plan, assign steps, track completion
4. Anonymous communication works without identity leak
5. Power user features (shortcuts, command palette, saved views) functional
</success_criteria>

<output>
After completion, create `.planning/phases/06-case-management/06-16-SUMMARY.md`
</output>
