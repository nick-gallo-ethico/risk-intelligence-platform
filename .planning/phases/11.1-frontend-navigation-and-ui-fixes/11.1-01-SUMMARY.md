---
phase: 11.1-frontend-navigation-and-ui-fixes
plan: 01
subsystem: frontend-navigation
tags: [sidebar, navigation, shadcn-ui, role-based-access]
depends_on:
  requires: []
  provides:
    - SidebarProvider context for all authenticated routes
    - Icon rail sidebar with collapsible mode
    - Role-based admin navigation filtering
    - Authenticated route group with shared layout
  affects:
    - 11.1-02: Mobile bottom nav integration
    - 11.1-03+: All pages in authenticated route group
tech-stack:
  added:
    - "@radix-ui/react-tooltip (via shadcn/ui sidebar)"
  patterns:
    - Icon rail sidebar with collapsible="icon" mode
    - Route groups for layout sharing ((authenticated))
    - Role-based navigation filtering
key-files:
  created:
    - apps/frontend/src/components/ui/sidebar.tsx
    - apps/frontend/src/components/layout/app-sidebar.tsx
    - apps/frontend/src/components/layout/nav-main.tsx
    - apps/frontend/src/components/layout/nav-admin.tsx
    - apps/frontend/src/lib/navigation.ts
    - apps/frontend/src/hooks/use-mobile.tsx
    - apps/frontend/src/app/(authenticated)/dashboard/page.tsx
    - apps/frontend/src/app/(authenticated)/cases/page.tsx
    - apps/frontend/src/app/(authenticated)/cases/[id]/page.tsx
    - apps/frontend/src/app/(authenticated)/cases/new/page.tsx
    - apps/frontend/src/app/(authenticated)/investigations/[id]/page.tsx
    - apps/frontend/src/app/(authenticated)/policies/page.tsx
  modified:
    - apps/frontend/src/components/ui/button.tsx
    - apps/frontend/src/components/ui/separator.tsx
    - apps/frontend/src/components/ui/sheet.tsx
    - apps/frontend/src/components/ui/tooltip.tsx
    - apps/frontend/src/components/ui/input.tsx
    - apps/frontend/src/components/ui/skeleton.tsx
    - apps/frontend/tailwind.config.ts
    - apps/frontend/src/app/globals.css
decisions:
  - id: nav-001
    decision: Use shadcn/ui sidebar component with collapsible="icon" mode
    rationale: Official component with built-in mobile handling, keyboard shortcuts, and cookie persistence
  - id: nav-002
    decision: Icon rail mode as default (collapsed) with expand toggle in footer
    rationale: Matches CONTEXT.md preference for icon rail with flyout pattern
  - id: nav-003
    decision: Admin section hidden entirely for non-admin roles (not empty)
    rationale: Per CONTEXT.md, hide admin icon for users with no admin access
metrics:
  duration: 13 min
  completed: 2026-02-05
---

# Phase 11.1 Plan 01: Install shadcn/ui Sidebar and Create Main Navigation Summary

**One-liner:** Icon rail sidebar with role-based admin visibility using shadcn/ui composable primitives

## What Was Built

### Task 1: Install shadcn/ui Sidebar and Create Navigation Config
- Installed shadcn/ui sidebar component via `npx shadcn@latest add sidebar`
- Created `navigation.ts` with main navigation items (Home, Cases, Investigations, Disclosures, Policies, Projects, Analytics)
- Created admin navigation items with role requirements (Users, Roles, Settings, Audit Log, Integrations)
- Added utility functions: `hasAccess()`, `getAdminItemsForRole()`, `canSeeAdminSection()`
- Fixed import paths in sidebar.tsx to use project conventions (`@/hooks`, `@/lib`)

### Task 2: Create AppSidebar Component with Icon Rail
- Created `app-sidebar.tsx` with `collapsible="icon"` for icon rail mode
- Added Ethico logo in header with link to dashboard
- Created `nav-main.tsx` for main navigation with active state highlighting
- Created `nav-admin.tsx` with role-based visibility filtering
- Added AI Assistant button and collapse/expand toggle in footer
- Included SidebarRail for resize handle

### Task 3: Create Authenticated Layout with SidebarProvider
- Verified existing `(authenticated)/layout.tsx` already wraps routes with SidebarProvider
- Created new dashboard page without inline header (using sidebar layout)
- Created new cases list page without inline header
- Copied cases/[id] and cases/new to authenticated route group
- Copied investigations/[id] to authenticated route group
- Created new policies list page without inline header

## Technical Details

### Sidebar Architecture
```
SidebarProvider (cookie-persisted state)
  +-- Sidebar (collapsible="icon")
      +-- SidebarHeader (Logo)
      +-- SidebarContent
      |     +-- NavMain (main navigation)
      |     +-- NavAdmin (role-filtered, with separator)
      +-- SidebarFooter (AI button, collapse toggle)
      +-- SidebarRail (resize handle)
```

### Role-Based Admin Filtering
| Role | Visible Admin Items |
|------|---------------------|
| SYSTEM_ADMIN | All (Users, Roles, Settings, Audit Log, Integrations) |
| COMPLIANCE_OFFICER | Settings, Audit Log |
| Other roles | Admin section hidden entirely |

### Navigation Items
Main: Home, Cases, Investigations, Disclosures, Policies, Projects, Analytics
Admin: Users, Roles, Settings, Audit Log, Integrations

## Decisions Made

1. **shadcn/ui sidebar over custom** - Battle-tested component with accessibility, keyboard shortcuts (Ctrl+B), and SSR-safe cookie persistence
2. **Icon rail as default** - Collapsed state saves space, flyout shows labels on hover
3. **Hide admin section entirely** - Per context, non-admin users don't see the admin icon (not an empty section)

## Deviations from Plan

None - plan executed exactly as written.

## Next Phase Readiness

**Ready for Plan 02:** Mobile bottom navigation and AI panel (already created via parallel execution)

**Dependencies satisfied:**
- SidebarProvider context available
- AppSidebar component working
- Authenticated layout wrapping all routes
- Navigation configuration exported from lib/navigation.ts

## Commits

| Hash | Message |
|------|---------|
| a1cb40f | feat(11.1-01): install shadcn/ui sidebar and create navigation config |
| 849f29b | feat(11.1-01): create AppSidebar component with icon rail mode |
| e3348e8 | feat(11.1-01): move pages to authenticated route group with sidebar layout |
