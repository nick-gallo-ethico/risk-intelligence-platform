---
phase: 08-portals
plan: 12
type: execute
wave: 4
depends_on: ["08-08", "08-01"]
files_modified:
  - apps/frontend/src/app/ethics/[tenant]/layout.tsx
  - apps/frontend/src/components/ethics/tenant-theme-provider.tsx
  - apps/frontend/src/components/ethics/ethics-header.tsx
  - apps/frontend/src/components/ethics/ethics-home.tsx
  - apps/frontend/src/app/ethics/[tenant]/page.tsx
autonomous: true

must_haves:
  truths:
    - "Ethics Portal displays tenant-specific branding (logo, colors)"
    - "CSS custom properties are applied from branding API"
    - "Ethics Portal has home page with quick actions"
    - "Header shows tenant logo and language switcher"
  artifacts:
    - path: "apps/frontend/src/components/ethics/tenant-theme-provider.tsx"
      provides: "Provider that loads and applies tenant CSS"
      exports: ["TenantThemeProvider"]
    - path: "apps/frontend/src/app/ethics/[tenant]/layout.tsx"
      provides: "Tenant-scoped layout with theming"
      exports: ["default"]
  key_links:
    - from: "TenantThemeProvider"
      to: "/api/v1/public/branding/:tenant/css"
      via: "fetch call"
      pattern: "fetch.*branding.*css"
    - from: "layout.tsx"
      to: "TenantThemeProvider"
      via: "component wrapping"
      pattern: "<TenantThemeProvider"
---

<objective>
Create the Ethics Portal white-label theming integration and home page - loading tenant branding and applying CSS custom properties for the branded experience.

Purpose: Each tenant's Ethics Portal needs unique branding without code changes.
Output: TenantThemeProvider, tenant layout, header, and home page components.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-portals/08-CONTEXT.md
@.planning/phases/08-portals/08-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TenantThemeProvider and branding hooks</name>
  <files>
    apps/frontend/src/components/ethics/tenant-theme-provider.tsx
    apps/frontend/src/hooks/useTenantBranding.ts
    apps/frontend/src/components/ethics/theme-skeleton.tsx
  </files>
  <action>
Create src/hooks/useTenantBranding.ts:
- useTenantBranding(tenantSlug: string) hook
- Fetches from /api/v1/public/branding/:tenant (JSON config)
- Returns: branding (TenantBranding), isLoading, error
- Caches with 1-hour stale time (matches backend cache)

Create src/components/ethics/theme-skeleton.tsx:
- Loading skeleton while theme loads
- Neutral gray background
- Minimal skeleton elements (logo placeholder, content area)
- No jarring flash when theme applies

Create src/components/ethics/tenant-theme-provider.tsx per RESEARCH.md pattern:
- Props: tenantSlug (from route params), children
- Fetch CSS from /api/v1/public/branding/:tenant/css
- Inject CSS as style element in document head
- Clean up style element on unmount
- Show ThemeSkeleton while loading
- Handle error: show fallback theme (Ethico defaults)
- Store style element ID: 'tenant-theme'

Implementation:
```tsx
export function TenantThemeProvider({ tenantSlug, children }) {
  const [cssLoaded, setCssLoaded] = useState(false);

  useEffect(() => {
    async function loadTheme() {
      const response = await fetch(`/api/v1/public/branding/${tenantSlug}/css`);
      const css = await response.text();

      // Remove existing theme
      document.getElementById('tenant-theme')?.remove();

      // Inject new theme
      const style = document.createElement('style');
      style.id = 'tenant-theme';
      style.textContent = css;
      document.head.appendChild(style);

      setCssLoaded(true);
    }
    loadTheme();

    return () => {
      document.getElementById('tenant-theme')?.remove();
    };
  }, [tenantSlug]);

  if (!cssLoaded) return <ThemeSkeleton />;
  return <>{children}</>;
}
```
  </action>
  <verify>npm run build -- --filter=frontend</verify>
  <done>TenantThemeProvider with CSS injection created</done>
</task>

<task type="auto">
  <name>Task 2: Create Ethics Portal header and navigation</name>
  <files>
    apps/frontend/src/components/ethics/ethics-header.tsx
    apps/frontend/src/components/ethics/ethics-nav.tsx
    apps/frontend/src/components/ethics/ethics-footer.tsx
  </files>
  <action>
Create src/components/ethics/ethics-header.tsx:
- Props: branding (TenantBranding)
- Fixed top header with:
  - Tenant logo (from branding.logoUrl) on left
  - Navigation links in center (desktop only)
  - LanguageSwitcher on right
- Mobile: hamburger menu, logo centered
- Uses CSS custom property colors for theming
- Accessible: skip to content link, proper ARIA

Create src/components/ethics/ethics-nav.tsx:
- Props: currentPath
- Navigation links:
  - Home
  - Report an Issue
  - Check Status
  - Resources (if enabled for tenant)
- Active link highlighting
- Mobile: slide-out menu
- Desktop: horizontal nav

Create src/components/ethics/ethics-footer.tsx:
- Props: branding (TenantBranding)
- Footer text from branding.footerText or default
- Links: Privacy Policy, Terms of Use, Accessibility
- Copyright notice
- Optional: tenant-provided additional links
- Subdued styling per footer conventions
  </action>
  <verify>npm run build -- --filter=frontend</verify>
  <done>Ethics Portal header, nav, and footer components created</done>
</task>

<task type="auto">
  <name>Task 3: Create Ethics Portal layout and home page</name>
  <files>
    apps/frontend/src/app/ethics/[tenant]/layout.tsx
    apps/frontend/src/app/ethics/[tenant]/page.tsx
    apps/frontend/src/components/ethics/ethics-home.tsx
    apps/frontend/src/components/ethics/quick-actions.tsx
  </files>
  <action>
Create src/app/ethics/[tenant]/layout.tsx:
- Get tenant slug from route params
- Wrap children with TenantThemeProvider
- Render EthicsHeader at top
- Render main content area
- Render EthicsFooter at bottom
- Apply base layout styles (min-height: 100vh, flex column)
- i18next provider for translations

Create src/components/ethics/quick-actions.tsx:
- Card grid of primary actions:
  - "Report an Issue" (primary action, prominent)
  - "Check Status"
  - "Ask a Question" (if chatbot enabled)
  - "Browse Resources" (if resources enabled)
- Each card: icon, title, brief description
- Mobile: stack vertically
- Desktop: 2x2 grid

Create src/components/ethics/ethics-home.tsx:
- Props: branding, tenantConfig
- Welcome section:
  - Welcome video (if branding.welcomeVideoUrl)
  - Welcome message from tenant config
- Announcements section (if any)
- QuickActions component
- "How it works" section with 3 steps
- Trust indicators (anonymous, secure, confidential badges)

Create src/app/ethics/[tenant]/page.tsx:
- Load tenant config from /api/v1/public/ethics/:tenant/config
- Load branding via useTenantBranding
- Render EthicsHome with config and branding
- Handle tenant not found (404 page)
- Meta tags: title from tenant name, description
  </action>
  <verify>npm run build -- --filter=frontend</verify>
  <done>Ethics Portal layout and home page created</done>
</task>

</tasks>

<verification>
1. Run `npm run build -- --filter=frontend` to verify compilation
2. Verify theme CSS is injected from branding endpoint
3. Verify tenant logo displays in header
4. Verify quick actions navigate to correct routes
5. Test different screen sizes for responsive layout
</verification>

<success_criteria>
- TenantThemeProvider loads and injects CSS from branding API
- Header displays tenant logo and language switcher
- Navigation shows appropriate links for tenant
- Home page shows quick actions for primary user flows
- Theme skeleton prevents flash of unstyled content
</success_criteria>

<output>
After completion, create `.planning/phases/08-portals/08-12-SUMMARY.md`
</output>
