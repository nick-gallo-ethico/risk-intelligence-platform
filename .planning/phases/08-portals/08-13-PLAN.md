---
phase: 08-portals
plan: 13
type: execute
wave: 5
depends_on: ["08-06"]
files_modified:
  - apps/frontend/src/app/employee/layout.tsx
  - apps/frontend/src/app/employee/page.tsx
  - apps/frontend/src/components/employee/employee-dashboard.tsx
  - apps/frontend/src/components/employee/dashboard-tabs.tsx
  - apps/frontend/src/components/employee/my-tasks-tab.tsx
  - apps/frontend/src/components/employee/my-team-tab.tsx
autonomous: true

must_haves:
  truths:
    - "Employee Portal requires SSO authentication"
    - "Dashboard shows role-aware tabs (My Tasks, My Team for managers)"
    - "Tasks are displayed with due dates and overdue indicators"
    - "Manager tab shows team compliance status"
  artifacts:
    - path: "apps/frontend/src/app/employee/layout.tsx"
      provides: "Employee Portal layout with authentication"
      exports: ["default"]
    - path: "apps/frontend/src/components/employee/employee-dashboard.tsx"
      provides: "Main dashboard with role-aware tabs"
      exports: ["EmployeeDashboard"]
  key_links:
    - from: "employee/layout.tsx"
      to: "AuthGuard"
      via: "component wrapping"
      pattern: "AuthGuard|useAuth"
    - from: "MyTasksTab"
      to: "/api/v1/employee/tasks"
      via: "fetch call"
      pattern: "fetch.*employee/tasks"
    - from: "TaskCard action buttons"
      to: "Phase 9 Campaigns completion UIs"
      via: "navigation links (completion UIs built in Phase 9)"
      pattern: "router\\.push.*campaign|attestation|disclosure"
---

<objective>
Create the Employee Portal dashboard with role-aware tabs - the authenticated self-service portal where employees manage their compliance tasks and managers view team status.

Purpose: Employees need a single place to see and complete compliance tasks; managers need visibility into team compliance.
Output: Employee dashboard with tabs for tasks, team (managers), history, and policies.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-portals/08-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Employee Portal layout with authentication</name>
  <files>
    apps/frontend/src/app/employee/layout.tsx
    apps/frontend/src/components/employee/employee-header.tsx
    apps/frontend/src/hooks/useEmployeeProfile.ts
  </files>
  <action>
Create src/hooks/useEmployeeProfile.ts:
- useEmployeeProfile() hook
- Fetches authenticated user's employee profile
- Returns: profile (name, role, isManager, department, pendingTaskCount), isLoading
- Determines isManager from user's PersonManager relationships
- Caches with 5-minute stale time

Create src/components/employee/employee-header.tsx:
- User avatar and name
- Department/role display
- Notification bell with unread count
- Quick action dropdown: Report Issue, Settings, Logout
- Mobile: hamburger for navigation

Create src/app/employee/layout.tsx:
- Require authentication (use existing auth guard/hook)
- If not authenticated: redirect to SSO login
- If authenticated but no employee profile: show onboarding
- Render EmployeeHeader
- Sidebar navigation (desktop) / bottom nav (mobile):
  - Dashboard (home)
  - Tasks
  - History
  - Policies
- Load employee profile via useEmployeeProfile
- Pass isManager to children via context or prop
  </action>
  <verify>npm run build -- --filter=frontend</verify>
  <done>Employee Portal layout with authentication created</done>
</task>

<task type="auto">
  <name>Task 2: Create dashboard with role-aware tabs</name>
  <files>
    apps/frontend/src/app/employee/page.tsx
    apps/frontend/src/components/employee/employee-dashboard.tsx
    apps/frontend/src/components/employee/dashboard-tabs.tsx
  </files>
  <action>
Create src/components/employee/dashboard-tabs.tsx:
- Props: isManager, activeTab, onTabChange
- Tab list:
  - My Tasks (always shown, default)
  - My Team (only if isManager = true)
  - My History
  - Policies
- Badge on My Tasks showing pending count
- Badge on My Team showing "needs attention" count (for managers)
- Responsive: horizontal tabs on desktop, bottom nav on mobile

Create src/components/employee/employee-dashboard.tsx:
- Props: employeeProfile
- Welcome message with name
- Overview cards row:
  - Pending Tasks count
  - Overdue Tasks count (if any, red)
  - Upcoming Due (next 7 days)
  - Compliance Score (percentage)
- DashboardTabs component
- Tab content area (renders selected tab content)

Create src/app/employee/page.tsx:
- Load task counts from /api/v1/employee/tasks/counts
- Load overview from /api/v1/employee/overview
- Render EmployeeDashboard with data
- Handle tab navigation via URL query param (?tab=tasks)
  </action>
  <verify>npm run build -- --filter=frontend</verify>
  <done>Dashboard with role-aware tabs created</done>
</task>

<task type="auto">
  <name>Task 3: Create My Tasks and My Team tab content</name>
  <files>
    apps/frontend/src/components/employee/my-tasks-tab.tsx
    apps/frontend/src/components/employee/my-team-tab.tsx
    apps/frontend/src/components/employee/task-card.tsx
    apps/frontend/src/components/employee/team-member-row.tsx
  </files>
  <action>
Create src/components/employee/task-card.tsx:
- Props: task (EmployeeTask)
- Card display with:
  - Task type icon (attestation, disclosure, approval, follow-up)
  - Title
  - Due date with relative time (e.g., "Due in 2 days", "Overdue by 3 days")
  - Status badge
  - Action button (Complete, View, Respond)
- Overdue styling: red border, warning icon
- Click to navigate to task detail/completion page
- Note: Actual attestation/disclosure completion UIs are implemented in Phase 9 (Campaigns)
- Task card action buttons link to Phase 9 completion flows when available

Create src/components/employee/my-tasks-tab.tsx:
- Fetch tasks from /api/v1/employee/tasks
- Sub-tabs: Pending, Overdue, Recently Completed
- Filter dropdown: All, Attestations, Disclosures, Approvals
- Sort: Due date, Type
- Task list using TaskCard component
- Empty state for each sub-tab
- Pagination or infinite scroll

Create src/components/employee/team-member-row.tsx:
- Props: teamMember (TeamMember with compliance status)
- Row display: avatar, name, role, compliance score, pending items count
- Color coding: green (compliant), amber (pending), red (overdue)
- Click to expand: see specific pending items
- Send reminder button (bulk action available)

Create src/components/employee/my-team-tab.tsx:
- Only renders if user is manager
- Fetch team from /api/v1/employee/team
- Summary stats: total members, compliant, needs attention
- Team member list using TeamMemberRow
- Bulk reminder action for overdue members
- Export button (CSV of team status)
- Search/filter by name, department
  </action>
  <verify>npm run build -- --filter=frontend</verify>
  <done>My Tasks and My Team tabs with components created</done>
</task>

</tasks>

<verification>
1. Run `npm run build -- --filter=frontend` to verify compilation
2. Verify authentication redirects to login if not authenticated
3. Verify My Team tab only shows for managers
4. Verify tasks display with due date and overdue indicators
5. Test responsive layout on mobile
</verification>

<success_criteria>
- Employee Portal requires authentication to access
- Dashboard shows personalized welcome and overview stats
- My Tasks tab shows pending tasks with due dates
- My Team tab only visible for managers
- Overdue tasks have prominent visual indicators
- Task action buttons are wired to navigation (completion UIs come in Phase 9)
</success_criteria>

<output>
After completion, create `.planning/phases/08-portals/08-13-SUMMARY.md`
</output>
