---
phase: 22-dark-mode-theme
plan: 04
type: execute
wave: 2
depends_on: ["22-01"]
files_modified:
  - apps/frontend/src/app/(authenticated)/layout.tsx
  - apps/frontend/src/components/layout/top-nav.tsx
  - apps/frontend/src/components/layout/app-sidebar.tsx
  - apps/frontend/src/components/layout/nav-main.tsx
  - apps/frontend/src/components/layout/nav-admin.tsx
  - apps/frontend/src/components/layout/mobile-bottom-nav.tsx
  - apps/frontend/src/components/layout/mobile-more-drawer.tsx
  - apps/frontend/src/components/layout/ai-panel.tsx
  - apps/frontend/src/components/layouts/InternalLayout.tsx
  - apps/frontend/src/app/login/page.tsx
  - apps/frontend/src/app/page.tsx
  - apps/frontend/src/components/common/command-palette.tsx
  - apps/frontend/src/components/common/shortcuts-help-dialog.tsx
  - apps/frontend/src/components/common/empty-state.tsx
autonomous: true

must_haves:
  truths:
    - "Top nav and sidebar are visually consistent in both light and dark modes"
    - "In dark mode, top nav maintains dark navy but has subtle differentiation from content area"
    - "Mobile bottom nav and drawer render correctly in dark mode"
    - "AI panel renders correctly in dark mode"
    - "Internal layout renders correctly in dark mode"
    - "Login page renders correctly in dark mode"
    - "Command palette renders correctly in dark mode"
  artifacts:
    - path: "apps/frontend/src/components/layout/top-nav.tsx"
      provides: "Dark-mode-compatible top navigation"
    - path: "apps/frontend/src/components/layouts/InternalLayout.tsx"
      provides: "Dark-mode-compatible internal layout"
  key_links:
    - from: "app/(authenticated)/layout.tsx"
      to: "app-sidebar.tsx"
      via: "SidebarProvider + AppSidebar"
      pattern: "AppSidebar"
---

<objective>
Fix all layout components, navigation elements, and common/shared components for dark mode. The navigation bars are the most visible elements — they must look polished in both themes. This plan also covers the login page, internal layout, command palette, and other shared components.

Purpose: Layout components frame every page. Getting them right establishes the visual foundation for dark mode across the entire app (success criteria #5).
Output: All layout, navigation, and common components render correctly in dark mode.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-dark-mode-theme/22-RESEARCH.md
@apps/frontend/src/components/layout/top-nav.tsx
@apps/frontend/src/components/layout/app-sidebar.tsx
@apps/frontend/src/components/layouts/InternalLayout.tsx
@apps/frontend/src/components/common/command-palette.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix navigation components for dark mode</name>
  <files>
    apps/frontend/src/components/layout/top-nav.tsx
    apps/frontend/src/components/layout/app-sidebar.tsx
    apps/frontend/src/components/layout/nav-main.tsx
    apps/frontend/src/components/layout/nav-admin.tsx
    apps/frontend/src/components/layout/mobile-bottom-nav.tsx
    apps/frontend/src/components/layout/mobile-more-drawer.tsx
    apps/frontend/src/components/layout/ai-panel.tsx
  </files>
  <action>
**Top Navigation (`top-nav.tsx`):**
- The top nav uses `bg-[hsl(227,36%,13%)]` (Ethico navy) — this should STAY dark in both modes (HubSpot pattern: always-dark top nav)
- In dark mode, add a subtle bottom border to differentiate from the content area: `dark:border-b dark:border-white/10` or use `border-b border-white/5 dark:border-white/10`
- Replace any `text-white/XX` patterns with values that work in both modes. Since the nav is always dark, white text is correct in both modes — no changes needed for text colors inside the nav
- Check search input styling within the nav — it may use `bg-white/10` which is fine for a dark nav bar
- The user dropdown content (DropdownMenuContent) should use semantic tokens (`bg-popover`, `text-popover-foreground`) which auto-adapt

**App Sidebar (`app-sidebar.tsx`):**
- Sidebar already uses `--sidebar-*` CSS variables with dark variants defined in globals.css
- Verify no hardcoded `bg-gray-*` or `text-gray-*` classes override the CSS variable system
- Check any conditional className logic for hardcoded colors

**Nav Main & Nav Admin (`nav-main.tsx`, `nav-admin.tsx`):**
- Replace any `text-gray-*` with `text-sidebar-foreground` or `text-sidebar-foreground/60`
- Replace any `hover:bg-gray-*` with `hover:bg-sidebar-accent`
- Active item styling should use sidebar tokens

**Mobile Bottom Nav (`mobile-bottom-nav.tsx`):**
- Replace `bg-white` with `bg-background`
- Replace `border-gray-200` with `border-border`
- Replace `text-gray-500` with `text-muted-foreground`
- Active tab: keep accent color or use `text-primary`

**Mobile More Drawer (`mobile-more-drawer.tsx`):**
- Replace `bg-white` with `bg-background`
- Replace `text-gray-*` with `text-foreground` / `text-muted-foreground`

**AI Panel (`ai-panel.tsx`):**
- Replace `bg-white` with `bg-background` or `bg-card`
- Replace `text-gray-*` with `text-foreground` / `text-muted-foreground`
- Replace `border-gray-*` with `border-border`
- Chat message bubbles may need distinct dark mode styling
  </action>
  <verify>
  - `cd apps/frontend && npx tsc --noEmit` should compile without errors
  - Top nav stays dark in both modes with subtle differentiation in dark mode
  - Sidebar transitions smoothly between light and dark mode
  - Mobile nav usable in both modes
  </verify>
  <done>All navigation components render correctly in both light and dark modes. Top nav has subtle dark mode differentiation. Sidebar uses CSS variable system. Mobile components adapted.</done>
</task>

<task type="auto">
  <name>Task 2: Fix layouts, login page, and common components</name>
  <files>
    apps/frontend/src/app/(authenticated)/layout.tsx
    apps/frontend/src/components/layouts/InternalLayout.tsx
    apps/frontend/src/app/login/page.tsx
    apps/frontend/src/app/page.tsx
    apps/frontend/src/components/common/command-palette.tsx
    apps/frontend/src/components/common/shortcuts-help-dialog.tsx
    apps/frontend/src/components/common/empty-state.tsx
  </files>
  <action>
**Authenticated Layout (`(authenticated)/layout.tsx`):**
- Check the main content area wrapper — if it uses `bg-gray-50` or `bg-white`, replace with `bg-background`
- Any sidebar wrapper styling should use sidebar tokens

**Internal Layout (`InternalLayout.tsx`):**
- Has ~6 hardcoded color occurrences
- Replace `bg-gray-50` page background with `bg-background` or `bg-muted`
- Replace `bg-white` card backgrounds with `bg-card`
- Replace `text-gray-*` with semantic tokens
- Replace `border-gray-*` with `border-border`

**Login Page (`login/page.tsx`):**
- Replace `bg-white` / `bg-gray-50` with `bg-background` / `bg-card`
- Replace `text-gray-*` with `text-foreground` / `text-muted-foreground`
- Ensure Ethico branding (gradients, logo) looks good on dark background

**Root Page (`page.tsx`):**
- Replace any hardcoded colors with semantic tokens

**Command Palette (`command-palette.tsx`):**
- ~16 hardcoded color occurrences
- Replace `bg-white` with `bg-popover` / `bg-background`
- Replace `text-gray-*` with `text-foreground` / `text-muted-foreground`
- Replace `border-gray-*` with `border-border`
- Search input: `bg-gray-50` → `bg-muted`
- Group headers: `text-gray-500` → `text-muted-foreground`
- Result items hover: `hover:bg-gray-100` → `hover:bg-accent`
- Active item: check highlight color
- Keyboard shortcut badges: `bg-gray-100` → `bg-muted`

**Shortcuts Help Dialog (`shortcuts-help-dialog.tsx`):**
- ~8 hardcoded color occurrences
- Replace `bg-gray-100` kbd elements with `bg-muted`
- Replace `text-gray-*` with semantic tokens
- Replace `border-gray-*` with `border-border`

**Empty State (`empty-state.tsx`):**
- Replace `text-gray-*` with `text-muted-foreground`
- Replace any `bg-gray-*` icon backgrounds with `bg-muted`
  </action>
  <verify>
  - `cd apps/frontend && npx tsc --noEmit` should compile without errors
  - Login page readable in dark mode
  - Command palette usable in dark mode
  - Internal layout properly themed
  </verify>
  <done>All layout components, login page, and common components render correctly in dark mode. No hardcoded colors remain that lack dark variants.</done>
</task>

</tasks>

<verification>
- `cd apps/frontend && npx tsc --noEmit` passes
- Navigation bars visually consistent in both modes (success criteria #5)
- Login page looks polished in dark mode
- Command palette and shortcuts dialog usable in dark mode
</verification>

<success_criteria>
- Top nav and sidebar visually consistent in both modes
- All layout shells (authenticated, internal, employee, operator) adapted
- Login page, command palette, and shared components dark-mode-ready
</success_criteria>

<output>
After completion, create `.planning/phases/22-dark-mode-theme/22-04-SUMMARY.md`
</output>
