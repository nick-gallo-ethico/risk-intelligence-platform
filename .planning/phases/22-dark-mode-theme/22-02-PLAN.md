---
phase: 22-dark-mode-theme
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/frontend/src/components/layout/theme-toggle.tsx
  - apps/frontend/src/components/layout/top-nav.tsx
  - apps/frontend/src/lib/theme-colors.ts
autonomous: true

must_haves:
  truths:
    - "Theme toggle with Light/Dark/System options exists in user dropdown menu"
    - "Theme toggle shows current theme state with appropriate icon"
    - "Clicking theme option immediately switches the theme"
    - "Status color utility provides consistent dark mode mappings for all semantic colors"
  artifacts:
    - path: "apps/frontend/src/components/layout/theme-toggle.tsx"
      provides: "Theme toggle component for user menu"
      contains: "useTheme"
    - path: "apps/frontend/src/lib/theme-colors.ts"
      provides: "Shared status color utilities with dark mode variants"
      contains: "statusColors"
  key_links:
    - from: "theme-toggle.tsx"
      to: "next-themes"
      via: "useTheme hook"
      pattern: "useTheme"
    - from: "top-nav.tsx"
      to: "theme-toggle.tsx"
      via: "ThemeToggle import in user dropdown"
      pattern: "ThemeToggle"
---

<objective>
Create the theme toggle UI component and a shared status color utility system. The toggle goes in the user dropdown menu (top-nav). The status color utility provides reusable dark mode color mappings that all components will use, preventing inconsistency across ~534 semantic color occurrences.

Purpose: Users need a visible way to switch themes (success criteria #1). The status color utility centralizes the most repetitive dark mode pattern to avoid 534+ individual `dark:` additions.
Output: ThemeToggle component in user menu, theme-colors.ts utility with comprehensive status color mappings.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-dark-mode-theme/22-RESEARCH.md
@apps/frontend/src/components/layout/top-nav.tsx
@apps/frontend/src/components/ui/status-badge.tsx
@apps/frontend/src/components/ui/severity-badge.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ThemeToggle component and add to user dropdown</name>
  <files>
    apps/frontend/src/components/layout/theme-toggle.tsx
    apps/frontend/src/components/layout/top-nav.tsx
  </files>
  <action>
1. Create `apps/frontend/src/components/layout/theme-toggle.tsx`:

A client component that renders theme options for the user dropdown menu. Uses `useTheme` from `next-themes`.

```tsx
'use client';

import { useTheme } from 'next-themes';
import { Monitor, Moon, Sun } from 'lucide-react';
import { DropdownMenuItem } from '@/components/ui/dropdown-menu';

const themes = [
  { value: 'light', label: 'Light', icon: Sun },
  { value: 'dark', label: 'Dark', icon: Moon },
  { value: 'system', label: 'System', icon: Monitor },
] as const;

export function ThemeToggleItems() {
  const { theme, setTheme } = useTheme();

  return (
    <>
      {themes.map(({ value, label, icon: Icon }) => (
        <DropdownMenuItem
          key={value}
          onClick={() => setTheme(value)}
          className="flex items-center gap-2"
        >
          <Icon className="h-4 w-4" />
          <span>{label}</span>
          {theme === value && (
            <span className="ml-auto text-xs text-muted-foreground">✓</span>
          )}
        </DropdownMenuItem>
      ))}
    </>
  );
}
```

2. Update `apps/frontend/src/components/layout/top-nav.tsx`:

Find the user profile dropdown section (the DropdownMenuContent that contains "My Profile", "My Tasks", "Settings", "Log out" items). Add a theme section:

- Import `ThemeToggleItems` from `./theme-toggle`
- Add a `DropdownMenuSeparator` after the existing items (before Log out)
- Add a `DropdownMenuLabel` with text "Theme"
- Add `<ThemeToggleItems />`
- Add another `DropdownMenuSeparator` before Log out

The dropdown structure should be:
```
My Profile
My Tasks
Settings
---
Theme (label)
  Light
  Dark
  System
---
Log out
```

Import `DropdownMenuLabel` and `DropdownMenuSeparator` from `@/components/ui/dropdown-menu` if not already imported.
  </action>
  <verify>
  - `cd apps/frontend && npx tsc --noEmit` should compile without errors
  - User dropdown should show Light/Dark/System options under a "Theme" section
  - Clicking an option should switch the theme immediately
  </verify>
  <done>ThemeToggle component renders Light/Dark/System options in user dropdown with active indicator. Theme switches immediately on click.</done>
</task>

<task type="auto">
  <name>Task 2: Create shared status color utility system</name>
  <files>apps/frontend/src/lib/theme-colors.ts</files>
  <action>
Create `apps/frontend/src/lib/theme-colors.ts` — a centralized utility for status and semantic colors with built-in dark mode variants.

This utility replaces the pattern of manually adding `dark:` variants to every component that uses semantic colors like `bg-blue-100 text-blue-800`. Instead, components import from this file and get consistent dark mode support.

```typescript
/**
 * Centralized theme-aware color mappings for status indicators, severity levels,
 * and semantic color patterns. Each mapping includes both light and dark mode classes.
 *
 * Usage:
 *   import { statusColors, severityColors, semanticColors } from '@/lib/theme-colors';
 *   <Badge className={statusColors.NEW}>New</Badge>
 */

// === Status Colors (Case, RIU, Campaign, etc.) ===
export const statusColors: Record<string, string> = {
  // Case/RIU statuses
  NEW: 'bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800',
  OPEN: 'bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-300 dark:border-yellow-800',
  IN_PROGRESS: 'bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800',
  IN_REVIEW: 'bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900/30 dark:text-purple-300 dark:border-purple-800',
  PENDING: 'bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800',
  PENDING_REVIEW: 'bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800',
  PENDING_APPROVAL: 'bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800',
  APPROVED: 'bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800',
  RESOLVED: 'bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800',
  COMPLETED: 'bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800',
  CLOSED: 'bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700',
  CANCELLED: 'bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-700',
  REJECTED: 'bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800',
  DRAFT: 'bg-gray-100 text-gray-700 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700',
  PUBLISHED: 'bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800',
  RETIRED: 'bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-700',
  ACTIVE: 'bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800',
  INACTIVE: 'bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-700',
  SCHEDULED: 'bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800',
  PAUSED: 'bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800',
  OVERDUE: 'bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800',
  AT_RISK: 'bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800',
  STUCK: 'bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800',
  NOT_STARTED: 'bg-gray-100 text-gray-700 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700',
  DONE: 'bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800',
  AWAITING_APPROVAL: 'bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900/30 dark:text-purple-300 dark:border-purple-800',
  SKIPPED: 'bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800',
  // QA statuses
  QA_PENDING: 'bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800',
  QA_APPROVED: 'bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800',
  QA_REJECTED: 'bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800',
  NEEDS_REVISION: 'bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800',
};

// === Severity Colors ===
export const severityColors: Record<string, string> = {
  LOW: 'bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800',
  MEDIUM: 'bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-300 dark:border-yellow-800',
  HIGH: 'bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900/30 dark:text-orange-300 dark:border-orange-800',
  CRITICAL: 'bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800',
};

// === Priority Colors (project tasks) ===
export const priorityColors: Record<string, string> = {
  LOW: 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300',
  MEDIUM: 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300',
  HIGH: 'bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300',
  CRITICAL: 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300',
};

// === Generic Semantic Colors (for ad-hoc usage) ===
export const semanticColors = {
  success: 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300',
  warning: 'bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300',
  error: 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300',
  info: 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300',
  neutral: 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300',
  purple: 'bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300',
} as const;

// === Semantic Background Colors (for icon containers, cards, etc.) ===
export const semanticBgColors = {
  success: 'bg-green-50 dark:bg-green-900/20',
  warning: 'bg-amber-50 dark:bg-amber-900/20',
  error: 'bg-red-50 dark:bg-red-900/20',
  info: 'bg-blue-50 dark:bg-blue-900/20',
  neutral: 'bg-gray-50 dark:bg-gray-800/50',
  purple: 'bg-purple-50 dark:bg-purple-900/20',
} as const;

// === Semantic Text Colors (for icon colors, accent text) ===
export const semanticTextColors = {
  success: 'text-green-600 dark:text-green-400',
  warning: 'text-amber-600 dark:text-amber-400',
  error: 'text-red-600 dark:text-red-400',
  info: 'text-blue-600 dark:text-blue-400',
  neutral: 'text-gray-600 dark:text-gray-400',
  purple: 'text-purple-600 dark:text-purple-400',
} as const;

// === Helper: Get status color with fallback ===
export function getStatusColor(status: string): string {
  return statusColors[status] || statusColors.DRAFT;
}

export function getSeverityColor(severity: string): string {
  return severityColors[severity] || severityColors.MEDIUM;
}

export function getPriorityColor(priority: string): string {
  return priorityColors[priority] || priorityColors.MEDIUM;
}
```

This utility will be imported by components in subsequent plans to replace hardcoded color patterns.
  </action>
  <verify>
  - `cd apps/frontend && npx tsc --noEmit` should compile without errors
  - The file exports statusColors, severityColors, priorityColors, semanticColors, and helper functions
  </verify>
  <done>Comprehensive status color utility created with dark mode mappings for all status types, severities, priorities, and semantic color patterns. Helper functions provide fallback defaults.</done>
</task>

</tasks>

<verification>
- `cd apps/frontend && npx tsc --noEmit` passes
- ThemeToggle visible in user dropdown menu
- Clicking Light/Dark/System switches theme
- theme-colors.ts exports all status/severity/priority mappings
</verification>

<success_criteria>
- Theme toggle accessible from user menu (success criteria #1)
- Status color utility provides consistent dark mode mappings for all semantic colors
- All exported color mappings include both light and dark variants
</success_criteria>

<output>
After completion, create `.planning/phases/22-dark-mode-theme/22-02-SUMMARY.md`
</output>
