---
phase: 25.1-case-detail-page-vision-revision
plan: 08
type: execute
wave: 2
depends_on: [01]
files_modified:
  - apps/frontend/src/components/cases/tasks-card.tsx
  - apps/frontend/src/components/cases/remediation-status-card.tsx
  - apps/frontend/src/app/(authenticated)/cases/[id]/page.tsx
autonomous: true

must_haves:
  truths:
    - "Right sidebar has 9 cards total including Tasks and Remediation Status"
    - "Tasks card shows open tasks first, then recently completed, with inline checkboxes"
    - "Remediation Status card shows progress bar, count, and next due action"
    - "All 9 cards render in correct order per spec Section 17.1"
  artifacts:
    - path: "apps/frontend/src/components/cases/tasks-card.tsx"
      provides: "Right sidebar tasks card with checkboxes"
      contains: "TasksCard"
    - path: "apps/frontend/src/components/cases/remediation-status-card.tsx"
      provides: "Right sidebar remediation progress card"
      contains: "RemediationStatusCard"
  key_links:
    - from: "apps/frontend/src/app/(authenticated)/cases/[id]/page.tsx"
      to: "TasksCard"
      via: "right sidebar render"
      pattern: "TasksCard"
    - from: "apps/frontend/src/app/(authenticated)/cases/[id]/page.tsx"
      to: "RemediationStatusCard"
      via: "right sidebar render"
      pattern: "RemediationStatusCard"
---

<objective>
Add the two missing right sidebar cards (Tasks, Remediation Status) and ensure all 9 cards render in the correct order per spec Section 17.

Purpose: The right sidebar shows "who and what is connected to this case." Tasks and Remediation Status cards are new — they provide at-a-glance task progress and remediation tracking without switching tabs.
Output: TasksCard.tsx, RemediationStatusCard.tsx, 9-card right sidebar.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/25.1-case-detail-page-vision-revision/25.1-RESEARCH.md

# Key source files (existing right sidebar cards)

@apps/frontend/src/components/cases/case-workflow-panel.tsx
@apps/frontend/src/components/cases/connected-people-card.tsx
@apps/frontend/src/components/cases/linked-rius-card.tsx
@apps/frontend/src/components/cases/related-cases-card.tsx
@apps/frontend/src/components/cases/related-policies-card.tsx
@apps/frontend/src/components/cases/connected-documents-card.tsx
@apps/frontend/src/components/cases/ai-chat-panel.tsx
@apps/frontend/src/components/ui/association-card.tsx
@.planning/hubspot-view-system-spec.md (Sections 17.1-17.5)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TasksCard and RemediationStatusCard</name>
  <files>
    apps/frontend/src/components/cases/tasks-card.tsx
    apps/frontend/src/components/cases/remediation-status-card.tsx
  </files>
  <action>
1. **Create TasksCard** per spec Section 17.3:

```typescript
interface CaseTask {
  id: string;
  title: string;
  dueDate?: string;
  assigneeName?: string;
  isCompleted: boolean;
  completedAt?: string;
}

interface TasksCardProps {
  caseId: string;
  tasks: CaseTask[];
  onCreateTask: () => void;
  onToggleComplete: (taskId: string, completed: boolean) => void;
}
```

Use the AssociationCard wrapper (existing) for consistent HubSpot card styling:

- Title: "Tasks" with count badge "(N)"
- Add button: opens CreateTaskModal
- Content: list of tasks, open first, then recently completed (max 5 total)
- Each task item: checkbox (Checkbox from shadcn) + title + due date (right-aligned)
  - Below title: assignee name in muted text
  - Completed tasks: strikethrough title, green checkmark, completion date
- "View all tasks" link at bottom

Fetch tasks from the case's activity feed (filter for task_created/task_assigned actions) or from a dedicated tasks endpoint if available. For now, accept tasks as props.

2. **Create RemediationStatusCard** per spec Section 17.4:

```typescript
interface RemediationStatusCardProps {
  caseId: string;
  totalActions: number;
  completedActions: number;
  nextAction?: {
    title: string;
    dueDate: string;
    assignee: string;
  };
  onViewPlan: () => void; // Switch to Remediation tab
}
```

Layout:

- No AssociationCard wrapper needed (simpler layout)
- Title: "Remediation Status"
- Progress bar: horizontal bar filled to completion percentage. Use Tailwind width classes or inline style.
- Text: "{completedActions} of {totalActions} actions complete"
- If nextAction exists: "Next due: {title}" on one line, "Due: {date}" and "Assigned: {assignee}" below
- "View remediation plan" link at bottom — calls onViewPlan which switches to Remediation tab

**Empty states for new cards:**

- TasksCard: If no tasks, show "No tasks" with muted text "Create a task to track action items for this case." and the Add button.
- RemediationStatusCard: If no remediation plan exists, show "No remediation plan created" with muted text "Create a remediation plan from the Remediation tab." and "View remediation plan" link.
  </action>
  <verify> - TasksCard renders with checkbox list of tasks - Clicking checkbox toggles task completion - Add button triggers onCreateTask - RemediationStatusCard shows progress bar and completion count - Next action displays when available - "View remediation plan" link is clickable - TypeScript compiles
  </verify>
  <done>TasksCard with inline checkboxes and RemediationStatusCard with progress bar created</done>
  </task>

<task type="auto">
  <name>Task 2: Wire all 9 cards in right sidebar</name>
  <files>apps/frontend/src/app/(authenticated)/cases/[id]/page.tsx</files>
  <action>
Update page.tsx right sidebar to render all 9 cards in correct order per spec Section 17.1:

```tsx
{/* Right sidebar */}
<div className="space-y-4 p-4">
  {/* 1. Workflow Panel */}
  <CaseWorkflowPanel caseId={caseId} />

  {/* 2. Connected People */}
  <ConnectedPeopleCard caseId={caseId} ... />

  {/* 3. Linked RIUs */}
  <LinkedRiusCard caseId={caseId} ... />

  {/* 4. Related Cases */}
  <RelatedCasesCard caseId={caseId} ... />

  {/* 5. Related Policies */}
  <RelatedPoliciesCard caseId={caseId} ... />

  {/* 6. Connected Documents */}
  <ConnectedDocumentsCard caseId={caseId} ... />

  {/* 7. Tasks (NEW) */}
  <TasksCard
    caseId={caseId}
    tasks={caseTasks}
    onCreateTask={() => setCreateTaskModalOpen(true)}
    onToggleComplete={handleToggleTaskComplete}
  />

  {/* 8. Remediation Status (NEW) */}
  <RemediationStatusCard
    caseId={caseId}
    totalActions={remediationStats.total}
    completedActions={remediationStats.completed}
    nextAction={remediationStats.nextAction}
    onViewPlan={() => setActiveTab('remediation')}
  />

  {/* 9. AI Assistant */}
  <Button
    variant="outline"
    className="w-full"
    onClick={() => setAiPanelOpen(true)}
  >
    <Bot className="h-4 w-4 mr-2" /> Ask AI Assistant
  </Button>
</div>
```

For task data: extract tasks from case activities or case data. If the case API returns tasks, use them. If not, compute from activities filtered by task actions.

For remediation stats: compute from remediation data (if remediation plan exists on the case). If not available, show the card in empty state.

Ensure existing cards (Workflow, People, RIUs, Cases, Policies, Documents, AI) continue to work as they did before. Only ADD TasksCard and RemediationStatusCard in their correct positions.
</action>
<verify> - Right sidebar renders 9 cards in order: Workflow, People, RIUs, Cases, Policies, Documents, Tasks, Remediation Status, AI - TasksCard shows task list with checkboxes - RemediationStatusCard shows progress (or empty state) - AI button opens AI panel - All existing cards still function - `npm run typecheck` passes
</verify>
<done>Right sidebar renders all 9 cards in spec order with new Tasks and Remediation Status cards</done>
</task>

</tasks>

<verification>
1. Right sidebar has exactly 9 cards in correct order
2. TasksCard: shows tasks with checkboxes, add button, view all link
3. RemediationStatusCard: shows progress bar, count, next action
4. All 7 existing cards still function correctly
5. AI button still opens AI panel
6. `npm run typecheck` passes
</verification>

<success_criteria>

- 9 right sidebar cards in spec order
- TasksCard supports inline task completion
- RemediationStatusCard shows meaningful progress data
- No regression in existing cards
  </success_criteria>

<output>
After completion, create `.planning/phases/25.1-case-detail-page-vision-revision/25.1-08-SUMMARY.md`
</output>
