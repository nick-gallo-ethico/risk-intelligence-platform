---
phase: 24-policy-content-seed-data
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/backend/prisma/seeders/patterns/flagship-cases.ts
  - apps/backend/prisma/seeders/case.seeder.ts
  - apps/backend/prisma/seeders/data/narrative-templates.ts
autonomous: true

must_haves:
  truths:
    - "Flagship case narratives are 200-400 words each (currently 130-172)"
    - "Flagship case AI summaries are 50-75 words each (currently 24-35)"
    - "Regular case generateAiSummary produces 50-75 word summaries (currently 24-35)"
    - "Narrative templates produce 200+ word narratives for regular cases"
  artifacts:
    - path: "apps/backend/prisma/seeders/patterns/flagship-cases.ts"
      provides: "10 flagship cases with expanded narratives and summaries"
      contains: "FLAGSHIP_CASES"
    - path: "apps/backend/prisma/seeders/case.seeder.ts"
      provides: "Improved generateAiSummary function producing 50-75 word output"
      contains: "generateAiSummary"
    - path: "apps/backend/prisma/seeders/data/narrative-templates.ts"
      provides: "Enhanced templates generating 200+ word narratives"
      contains: "generateNarrative"
  key_links:
    - from: "apps/backend/prisma/seeders/case.seeder.ts"
      to: "apps/backend/prisma/seeders/data/narrative-templates.ts"
      via: "generateNarrative import"
      pattern: "import.*generateNarrative"
    - from: "apps/backend/prisma/seeders/case.seeder.ts"
      to: "apps/backend/prisma/seeders/patterns/flagship-cases.ts"
      via: "FLAGSHIP_CASES import"
      pattern: "import.*FLAGSHIP_CASES"
---

<objective>
Expand flagship case narratives to 200-400 words, AI summaries to 50-75 words. Fix regular case summary generation to produce 50-75 words. Enhance narrative templates to produce 200+ word narratives.

Purpose: Case detail pages need substantial content for demo walkthroughs. Currently flagship narratives are 130-172 words (target 200-400) and AI summaries are 24-35 words (target 50-75). Regular case narratives vary but many are under 200 words.

Output: Updated flagship-cases.ts, case.seeder.ts, and narrative-templates.ts with content meeting length requirements.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@apps/backend/prisma/seeders/patterns/flagship-cases.ts
@apps/backend/prisma/seeders/case.seeder.ts
@apps/backend/prisma/seeders/data/narrative-templates.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Expand flagship case narratives and summaries</name>
  <files>apps/backend/prisma/seeders/patterns/flagship-cases.ts</files>
  <action>
Expand all 10 flagship cases in the FLAGSHIP_CASES array. For each case:

**Narratives (target: 250-350 words each):**
Each narrative currently runs 130-172 words. Add 80-180 words of additional realistic detail to each. Maintain the existing writing style (first-person reports, professional language, specific details). Add content such as:

- Additional witness accounts or corroborating evidence
- Timeline details (specific dates, sequences of events)
- Impact statements (how the situation affected work, team morale, etc.)
- Prior attempts to resolve informally
- Specific policy references violated
- Quantitative details where relevant (dollar amounts, number of incidents, affected employees)

For each of the 10 cases, expand the `narrative` field. Do NOT change the `name`, `category`, `severity`, `status`, `aiRiskScore`, `durationDays`, `demoPoints`, `outcome`, or `referencePrefix` fields.

**AI Summaries (target: 55-70 words each):**
Each `aiSummary` currently runs 24-35 words. Expand to 55-70 words by adding:

- Specific risk factors identified
- Recommended investigation approach
- Key evidence noted
- Related policy references
- Urgency indicators

Example expansion for "The Chicago Warehouse Incident":
Before (31 words): "High-severity harassment case involving warehouse supervisor. Pattern of escalating hostile behavior with multiple independent reports. Prior informal complaints went unresolved. Recommend immediate intervention and comprehensive investigation."
After (~65 words): "High-severity harassment case involving third-shift warehouse supervisor with documented pattern of escalating hostile behavior spanning multiple months. Three independent reporters corroborate intimidation tactics including thrown objects and aggressive language. Two prior verbal complaints handled informally with no documented resolution suggest systemic management failure. Physical intimidation component elevates risk classification. Recommend immediate interim safety measures, comprehensive witness interviews, and review of regional HR complaint handling procedures."

Apply this pattern to all 10 cases. Ensure each summary is a realistic AI-generated assessment.
</action>
<verify>

- TypeScript compiles: `cd apps/backend && npx tsc --noEmit --skipLibCheck 2>&1 | head -20`
- Word count check: For each flagship narrative, count words. All should be 200-400.
- Word count check: For each aiSummary, count words. All should be 50-75.
  </verify>
  <done>
- All 10 flagship narratives are 200-400 words
- All 10 flagship AI summaries are 50-75 words
- Content maintains realistic professional tone
- No other fields on FlagshipCase objects changed
- TypeScript compiles without errors
  </done>
  </task>

<task type="auto">
  <name>Task 2: Fix generateAiSummary and enhance narrative templates</name>
  <files>apps/backend/prisma/seeders/case.seeder.ts, apps/backend/prisma/seeders/data/narrative-templates.ts</files>
  <action>
**Part A: Fix generateAiSummary in case.seeder.ts (lines 171-205)**

The current function produces ~24-35 word summaries by combining 3 short sentences from arrays. Target is 50-75 words. Restructure the function to:

1. Keep the existing prefix/middle/end pattern but expand each component:
   - `summaryPrefixes`: Expand to 2-3 sentences that describe the case type and severity context (15-20 words)
   - `summaryMiddle`: Expand to 2-3 sentences analyzing risk factors and patterns (15-25 words)
   - `summaryEnd`: Expand to 2-3 sentences with recommendations and next steps (15-25 words)

2. Add a `summaryDetail` array with category-specific analysis sentences (10-15 words each). Select 1-2 based on categoryName. Example entries:
   - For harassment: "Witness testimony suggests pattern behavior requiring immediate protective measures for affected employees."
   - For financial: "Financial documentation review and transaction analysis recommended to determine scope of irregularities."
   - For safety: "OSHA compliance review warranted alongside internal safety audit of affected facilities."
   - For discrimination: "Statistical analysis of promotion and compensation data recommended to identify systemic patterns."
   - For retaliation: "Temporal correlation between protected activity and adverse actions requires careful documentation."
   - Generic fallback: "Cross-reference with historical reports to identify potential recurring patterns or systemic issues."

3. Combine: prefix + detail + middle + end = 50-75 words.

**Part B: Enhance narrative templates in narrative-templates.ts**

The `generateNarrative` function currently produces narratives that can be under 200 words. Make these changes:

1. **Add a `conclusion` field** to the NarrativeTemplate interface (optional string). Add conclusion text to at least half the templates across categories. Conclusions add 30-50 words each. Example: "I am willing to provide additional details and participate in any investigation. I have preserved all relevant documentation and can identify other witnesses. I request that this matter be investigated promptly and that appropriate measures be taken to address the situation."

2. **In the `generateNarrative` function**, after building the narrative from opener + body + details:
   - Always append a closing paragraph. Add an array of 5-6 generic closing statements (each 40-60 words) that rotate. Examples:
     - "I have attempted to address this through informal channels without success. I am now bringing this to your attention formally because I believe the situation requires intervention. I am available to discuss this further and can provide additional documentation or witness names upon request. I request that my identity be protected to the extent possible."
     - "I want to emphasize that I am bringing this forward out of genuine concern for the well-being of employees and the integrity of the organization. I have documentation supporting these claims and am willing to cooperate fully with any investigation. Please treat this report with the urgency it deserves."
     - "This situation has been weighing on me for some time, and I feel it is my responsibility to bring it to the attention of the appropriate parties. I ask that this be investigated thoroughly and that any necessary corrective actions be implemented. I am prepared to provide a detailed statement if needed."

3. **Ensure the combined output** (opener + body + optional details + closing) consistently reaches 200-300 words for standard narratives. The long narrative addendum (for edge cases) is fine as-is.

Do NOT change the PLACEHOLDER_VALUES, category anonymityRate values, or template opener/body text. Only ADD conclusion text and the closing paragraph logic in generateNarrative.
</action>
<verify>

- TypeScript compiles: `cd apps/backend && npx tsc --noEmit --skipLibCheck 2>&1 | head -20`
- The generateAiSummary function output should average 50-75 words (manually verify by reading the template arrays)
- The generateNarrative function includes closing paragraph logic
- NarrativeTemplate interface includes optional conclusion field
  </verify>
  <done>
- generateAiSummary produces 50-75 word summaries combining prefix + category detail + middle + end
- narrative-templates includes closing paragraphs ensuring 200+ word output
- NarrativeTemplate interface updated with optional conclusion field
- All templates still compile and category configs preserved
- TypeScript compiles without errors
  </done>
  </task>

</tasks>

<verification>
1. `cd apps/backend && npx tsc --noEmit --skipLibCheck` compiles without errors
2. All 10 flagship narratives are 200-400 words
3. All 10 flagship AI summaries are 50-75 words
4. generateAiSummary template arrays produce 50-75 word output when combined
5. generateNarrative includes closing paragraph ensuring 200+ word output
</verification>

<success_criteria>

- Flagship narratives: 200-400 words each (all 10)
- Flagship AI summaries: 50-75 words each (all 10)
- Regular case AI summaries: 50-75 words (via improved generateAiSummary)
- Regular case narratives: 200+ words (via enhanced templates with closings)
- All changes compile without TypeScript errors
  </success_criteria>

<output>
After completion, create `.planning/phases/24-policy-content-seed-data/24-02-SUMMARY.md`
</output>
