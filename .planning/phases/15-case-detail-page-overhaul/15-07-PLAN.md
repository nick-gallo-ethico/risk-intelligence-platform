---
phase: 15-case-detail-page-overhaul
plan: 07
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/backend/prisma/seeders/case.seeder.ts
  - apps/backend/prisma/seeders/patterns/flagship-cases.ts
autonomous: true

must_haves:
  truths:
    - "Flagship case details are 200-400 words each"
    - "Flagship case summaries are 50-75 words each"
    - "Activity feed entries (notes, status changes, assignments) exist on flagship cases"
    - "Connected people (witness, subject) are seeded on flagship cases"
  artifacts:
    - path: "apps/backend/prisma/seeders/case.seeder.ts"
      provides: "Enhanced case seed logic with longer details and proper summaries"
      contains: "generateEnhancedDetails"
    - path: "apps/backend/prisma/seeders/patterns/flagship-cases.ts"
      provides: "Flagship case narratives with 200-400 word details and 50-75 word summaries"
      contains: "flagshipCases"
  key_links:
    - from: "case.seeder.ts"
      to: "flagship-cases.ts"
      via: "import flagship case patterns"
      pattern: "flagshipCases"
---

<objective>
Enhance seed data so flagship cases have 200-400 word details, 50-75 word summaries, activity feed entries, and connected people — making the case detail page look lived-in and realistic for demos.

Purpose: The research found that case details are currently passed through from RIU details (variable quality, often short) and summaries are truncated to 200 chars. The Phase 15 success criteria require 200-400 word details and 50-75 word summaries. Without this enhancement, the rebuilt case detail page looks sparse.

Output: Enhanced seeder files that produce richer demo data.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/backend/prisma/seeders/case.seeder.ts
@apps/backend/prisma/seeders/patterns/flagship-cases.ts
@.planning/phases/15-case-detail-page-overhaul/15-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance flagship case narratives with proper details and summaries</name>
  <files>
    apps/backend/prisma/seeders/patterns/flagship-cases.ts
  </files>
  <action>
    Update the flagship-cases.ts patterns file to include rich, 200-400 word details and 50-75 word summaries for each flagship case.

    For each of the ~10 flagship cases, provide:

    1. **details** field (200-400 words): A comprehensive case narrative that reads like an investigator's case file. Should include:
       - Initial report summary (who reported, when, how)
       - Key allegations or concerns
       - Relevant context (department, location, timeline)
       - Preliminary findings or observations
       - Next steps or investigation status
       - Format as natural prose paragraphs (not bullet points)

    2. **summary** field (50-75 words): A concise executive summary suitable for a dashboard view. Should capture:
       - What the case is about (one sentence)
       - Key parties involved
       - Current status/outcome in brief
       - Risk level indication

    Example flagship case detail (200-400 words):
    ```
    "This case was initiated following an anonymous report received via the company hotline on January 15, 2026, alleging systematic expense report falsification within the Southeast Regional Sales division. The reporter, who identified themselves as a member of the accounting team, provided specific examples of duplicate expense submissions totaling approximately $47,000 over a six-month period.

    Initial review of the expense management system confirmed irregular patterns in submissions from three sales representatives reporting to Regional Director Marcus Thompson. The flagged transactions include duplicate hotel receipts from the Atlanta and Miami offices, meals claimed during periods when the employees were recorded as working remotely, and transportation expenses with dates that do not align with calendar entries.

    The compliance team conducted preliminary interviews with the accounting department staff responsible for expense approvals. Two reviewers confirmed they had noticed anomalies but were told by their supervisor to process the claims as the sales team was under significant revenue pressure during Q3 and Q4 2025.

    A forensic review of digital records was initiated on January 22, 2026, covering all expense submissions from the Southeast region for the previous twelve months. The review identified 43 potentially fraudulent transactions across three employee accounts. Supporting documentation was requested from each employee on January 25, 2026, with a response deadline of February 5, 2026.

    The case has been escalated to High severity due to the financial impact exceeding the $25,000 threshold and the involvement of a regional director in the approval chain. Legal counsel has been notified and is monitoring the investigation. A formal investigation plan has been created with a target completion date of March 15, 2026."
    ```

    Example summary (50-75 words):
    ```
    "Anonymous hotline report alleging systematic expense falsification in the Southeast Regional Sales division, involving three sales representatives and approximately $47,000 in suspicious transactions over six months. Forensic review identified 43 potentially fraudulent expense claims. Case escalated to High severity due to financial threshold and management involvement. Investigation ongoing with target completion March 2026."
    ```

    Generate similar quality content for ALL flagship cases. Vary the categories: include harassment, retaliation, conflicts of interest, fraud, policy violations. Make each case distinct and realistic.

    Check the existing flagship-cases.ts structure to understand the data format. Add or update the `details` and `summary` fields on each flagship case pattern. If the existing structure doesn't have these fields, add them.

  </action>
  <verify>
    Read the updated flagship-cases.ts and count words in each details field (should be 200-400) and summary field (should be 50-75). Use a rough check: `details.split(/\s+/).length`.
  </verify>
  <done>
    All ~10 flagship cases have 200-400 word details and 50-75 word summaries. Content is realistic, varied across compliance categories, and reads like professional case documentation.
  </done>
</task>

<task type="auto">
  <name>Task 2: Enhance case seeder to use rich details, generate activities, and seed connected people</name>
  <files>
    apps/backend/prisma/seeders/case.seeder.ts
  </files>
  <action>
    Update case.seeder.ts to:

    1. **Use enhanced details from flagship patterns:**
       - When creating flagship cases, use the `details` and `summary` fields from the enhanced patterns instead of passing through RIU details
       - For non-flagship cases, enhance the existing detail generation:
         - Combine RIU details with additional generated context (investigator notes, timeline)
         - Target 150-300 words for non-flagship cases (acceptable to be shorter than flagship)
         - Generate proper summaries (40-60 words) instead of truncating details

    2. **Generate activity feed entries for flagship cases:**
       After creating each flagship case, seed 5-10 activity log entries. Check what the ActivityService or AuditLog expects, but the pattern should be creating AuditLog entries:
       ```typescript
       // Seed activities for flagship cases
       const activities = [
         { action: 'CREATED', description: 'Case created from hotline report', createdAt: caseCreatedAt },
         { action: 'ASSIGNED', description: 'Case assigned to Sarah Chen', createdAt: addDays(caseCreatedAt, 1) },
         { action: 'STATUS_CHANGED', description: 'Status changed from NEW to OPEN', createdAt: addDays(caseCreatedAt, 1) },
         { action: 'COMMENTED', description: 'Added initial assessment notes', createdAt: addDays(caseCreatedAt, 3) },
         { action: 'UPDATED', description: 'Priority escalated to HIGH', createdAt: addDays(caseCreatedAt, 5) },
       ];
       ```
       - Use the prisma client to create AuditLog entries or Activity entries (whichever model the activity timeline reads from)
       - Check what the ActivityTimelineService queries — it likely reads from AuditLog with entityType='CASE' and entityId=caseId
       - Vary the activities by case: some with more entries, some with fewer
       - Include realistic timestamps spread over the case's lifespan

    3. **Seed connected people on flagship cases:**
       - For each flagship case, create 2-4 PersonCaseAssociation records:
         - At least one SUBJECT (the person accused/investigated)
         - At least one WITNESS or REPORTER
         - Optionally an ASSIGNED_INVESTIGATOR role label
       - Link to existing seeded Person records where possible
       - If Person records don't exist yet at seed time, create simple ones

    Check the existing seeder flow carefully:
    - Understand the order of seeding (are Persons created before Cases?)
    - Use prisma.personCaseAssociation.create() or whatever the model is named
    - Include organizationId on all records for tenant isolation
    - Make sure the seeded data uses the correct Prisma enum values

    DO NOT change the seeding logic for non-flagship cases beyond the detail/summary enhancement.
    DO NOT modify the overall seed execution order or dependencies.

  </action>
  <verify>
    Run `cd apps/backend && npx tsc --noEmit` to verify compilation. Optionally run `npx prisma db seed` if safe to do so (check if it's destructive).
  </verify>
  <done>
    Case seeder generates 200-400 word details and 50-75 word summaries for flagships. Activity entries seeded (5-10 per flagship). Connected people seeded (2-4 associations per flagship with SUBJECT, WITNESS, REPORTER labels).
  </done>
</task>

</tasks>

<verification>
1. `cd apps/backend && npx tsc --noEmit` passes
2. Flagship cases have details field with 200-400 words (spot check 2-3 cases)
3. Flagship cases have summary field with 50-75 words (spot check 2-3 cases)
4. Activity seed code creates 5-10 AuditLog/Activity entries per flagship case
5. PersonCaseAssociation records created for flagship cases with varied labels
6. Non-flagship cases have improved details (150-300 words)
</verification>

<success_criteria>

- Flagship case details are 200-400 words with realistic compliance content
- Flagship case summaries are 50-75 words (not truncated details)
- Activity feed entries seeded: notes, status changes, assignments on flagship cases
- Connected people seeded: subjects, witnesses, reporters on flagship cases
- TypeScript compiles without errors
- Seed script remains idempotent and non-destructive to existing patterns
  </success_criteria>

<output>
After completion, create `.planning/phases/15-case-detail-page-overhaul/15-07-SUMMARY.md`
</output>
