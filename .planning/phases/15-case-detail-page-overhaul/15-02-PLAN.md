---
phase: 15-case-detail-page-overhaul
plan: 02
type: execute
wave: 2
depends_on: []
files_modified:
  - apps/frontend/src/app/(authenticated)/cases/[id]/page.tsx
  - apps/frontend/src/components/cases/case-info-summary.tsx
  - apps/frontend/src/components/cases/action-button-row.tsx
autonomous: true

must_haves:
  truths:
    - "Case detail page renders a three-column CSS Grid layout on desktop"
    - "Left column shows case number, status, pipeline stage, days open, and severity"
    - "Left column has action buttons: Note, Interview, Document, Task, Email"
    - "Left column contains case properties panel with RIU-specific form answers"
    - "Center column hosts the tabbed interface"
    - "Right column shell exists (placeholder content until Plan 05)"
  artifacts:
    - path: "apps/frontend/src/app/(authenticated)/cases/[id]/page.tsx"
      provides: "Three-column grid layout replacing two-column flex"
      contains: "grid-cols-[300px_1fr_300px]"
    - path: "apps/frontend/src/components/cases/case-info-summary.tsx"
      provides: "Case info card for top of left column"
      contains: "CaseInfoSummary"
    - path: "apps/frontend/src/components/cases/action-button-row.tsx"
      provides: "Action buttons for left column"
      contains: "ActionButtonRow"
  key_links:
    - from: "page.tsx"
      to: "case-info-summary.tsx"
      via: "import and render in left column"
      pattern: "CaseInfoSummary"
    - from: "page.tsx"
      to: "action-button-row.tsx"
      via: "import and render in left column"
      pattern: "ActionButtonRow"
    - from: "page.tsx"
      to: "case-tabs.tsx"
      via: "import and render in center column"
      pattern: "CaseTabs"
---

<objective>
Restructure the case detail page from a two-column (sidebar + tabs) layout to a three-column CSS Grid layout (left info/actions, center tabs, right entities) and build the left column components.

Purpose: The three-column layout is the fundamental architectural change this phase delivers. The left column becomes the case "at a glance" panel with quick-action buttons. This plan establishes the page skeleton that all subsequent plans build upon.

Output: Rebuilt page.tsx with three-column grid, CaseInfoSummary component, ActionButtonRow component.
</objective>

<execution_context>
@C:\Users\cu0718\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cu0718\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/frontend/src/app/(authenticated)/cases/[id]/page.tsx
@apps/frontend/src/components/cases/case-detail-header.tsx
@apps/frontend/src/components/cases/case-properties-panel.tsx
@apps/frontend/src/components/cases/case-tabs.tsx
@.planning/phases/15-case-detail-page-overhaul/15-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CaseInfoSummary and ActionButtonRow components</name>
  <files>
    apps/frontend/src/components/cases/case-info-summary.tsx
    apps/frontend/src/components/cases/action-button-row.tsx
  </files>
  <action>
    1. Create `case-info-summary.tsx`:
       - Props: `{ caseData: Case | null; isLoading: boolean }`
       - Display compact card at top of left column with:
         - Case reference number (e.g., ETH-2026-00123) in bold
         - Status badge (reuse STATUS_CONFIG pattern from case-detail-header.tsx)
         - Severity badge
         - Pipeline stage (text, e.g., "INVESTIGATION")
         - Days open (calculate from createdAt to now, show as "42 days open")
         - Date created (formatted)
         - SLA status with color indicator
       - Use Skeleton components for loading state
       - Style: bg-white, compact spacing, p-4, border-b between sections
       - Use Lucide icons: Calendar, Clock, Shield, AlertTriangle as appropriate

    2. Create `action-button-row.tsx`:
       - Props: `{ caseId: string; onAction: (action: string) => void; className?: string }`
       - Render a vertical stack of 5 action buttons:
         - Note (StickyNote icon) - "Add Note"
         - Interview (Mic icon) - "Log Interview"
         - Document (FileText icon) - "Attach Document"
         - Task (CheckSquare icon) - "Create Task"
         - Email (Mail icon) - "Log Email"
       - Each button: full-width, left-aligned text + icon, variant="ghost", compact height
       - onClick calls `onAction('note')`, `onAction('interview')`, etc.
       - Style: p-4 container with "Quick Actions" header text in muted gray
       - Buttons should look like a sidebar menu - not loud primary buttons

    Both components should be 'use client' and import from '@/components/ui/*' (shadcn/ui).

  </action>
  <verify>
    Files exist and export named components. Run `cd apps/frontend && npx tsc --noEmit` to verify no type errors.
  </verify>
  <done>
    CaseInfoSummary renders case metadata (ref number, status, severity, pipeline, days open, SLA). ActionButtonRow renders 5 action buttons with callbacks.
  </done>
</task>

<task type="auto">
  <name>Task 2: Rebuild page.tsx with three-column grid layout</name>
  <files>
    apps/frontend/src/app/(authenticated)/cases/[id]/page.tsx
  </files>
  <action>
    Rewrite `page.tsx` to replace the current two-column flex layout with a three-column CSS Grid layout. Keep ALL existing logic (auth check, case fetching, error handling, shortcuts) — only change the JSX layout structure.

    The new layout structure should be:

    ```
    <div className="min-h-screen bg-gray-50 flex flex-col">
      <CaseDetailHeader ... />

      <div className="flex-1 grid grid-cols-1 lg:grid-cols-[300px_1fr_300px] overflow-hidden">
        {/* LEFT COLUMN */}
        <aside className="border-r overflow-y-auto bg-white hidden lg:block">
          <CaseInfoSummary caseData={caseData} isLoading={loading} />
          <ActionButtonRow caseId={caseData?.id ?? ''} onAction={handleAction} />
          <div className="border-t">
            <CasePropertiesPanel caseData={caseData} isLoading={loading} />
          </div>
        </aside>

        {/* CENTER COLUMN */}
        <main className="overflow-hidden bg-white">
          <CaseTabs caseData={caseData} isLoading={loading} ... />
        </main>

        {/* RIGHT COLUMN */}
        <aside className="border-l overflow-y-auto bg-gray-50/50 hidden lg:block p-4">
          {/* Placeholder - populated in Plan 05 */}
          <div className="text-sm text-gray-500 text-center py-8">
            Connected entities will appear here
          </div>
        </aside>
      </div>
    </div>
    ```

    Key changes from current code:
    1. REMOVE the sidebarOpen toggle state and the sidebar toggle button entirely. The left column is always visible on desktop (hidden on mobile via `hidden lg:block`).
    2. REPLACE `<div className="flex-1 flex overflow-hidden">` with `<div className="flex-1 grid grid-cols-1 lg:grid-cols-[300px_1fr_300px] overflow-hidden">`
    3. ADD the right column `<aside>` as third grid child
    4. MOVE CasePropertiesPanel below ActionButtonRow in the left column
    5. ADD a new `handleAction` callback that receives action type string. For now, each action just logs to console: `console.log('Action:', action)`. These will be wired to modals in Plan 04.
    6. Import CaseInfoSummary and ActionButtonRow
    7. KEEP all existing imports, state, effects, error handling, auth checks
    8. UPDATE the skeleton loader to match the three-column layout

    DO NOT modify CaseDetailHeader, CasePropertiesPanel, or CaseTabs — they stay as-is.
    DO NOT add any modals to this file — modals come in Plan 04.
    DO NOT populate the right column — that comes in Plan 05.

  </action>
  <verify>
    Run `cd apps/frontend && npx tsc --noEmit` to verify no type errors. Visually inspect the page at /cases/[id] — it should show three columns on desktop (left sidebar, center tabs, right placeholder).
  </verify>
  <done>
    page.tsx uses CSS Grid three-column layout. Left column contains CaseInfoSummary, ActionButtonRow, CasePropertiesPanel. Center column contains CaseTabs. Right column has placeholder. No sidebar toggle button.
  </done>
</task>

</tasks>

<verification>
1. `cd apps/frontend && npx tsc --noEmit` passes
2. page.tsx contains `grid-cols-[300px_1fr_300px]` or equivalent three-column grid
3. CaseInfoSummary component exists and renders case metadata
4. ActionButtonRow component exists with 5 buttons (Note, Interview, Document, Task, Email)
5. Left column: CaseInfoSummary + ActionButtonRow + CasePropertiesPanel (in that order)
6. Right column exists as third grid child (placeholder content OK)
7. No sidebar toggle button remains
</verification>

<success_criteria>

- Three-column CSS Grid layout renders on desktop viewports
- Left column displays case summary info and 5 action buttons
- Center column hosts CaseTabs (unchanged)
- Right column placeholder exists
- Page collapses to single column on mobile
- All existing functionality preserved (auth, fetching, error states, shortcuts)
  </success_criteria>

<output>
After completion, create `.planning/phases/15-case-detail-page-overhaul/15-02-SUMMARY.md`
</output>
